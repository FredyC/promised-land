/*
* The MIT License (MIT)
* 
* Copyright (c) 2014 FredyC (https://github.com/FredyC/promised-land/)
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
* 
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
* 
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
* 
* Version: 0.2.0
*/
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.land=t()}}(function(){var t,e,n;return function r(t,e,n){function i(s,u){if(!e[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=e[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,r,t,e,n)}return e[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e){"use strict";var n,r,i,o;i=t("bluebird"),n=t("baconjs"),r=t("eventemitter2").EventEmitter2,o=function(){var t,e,s,u,a;return e=Object.create(r.prototype),e.constructor=o,r.call(e,{wildcard:!1}),u=Object.create(null),e.promise=function(t,n){if(!arguments.length||null===t)return i.reject(new TypeError("missing event argument for promise call"));if("object"==typeof n){if("function"!=typeof n.once)throw new TypeError("specified emitter is missing once method");return new i(function(e,r){return n.once(t,function(t){return s(t,e,r)})})}return u[t]?u[t]:u[t]=new i(function(n,r){return e.once(t,function(t){return s(t,n,r)})})},e.promiseAll=function(){var t;return Array.prototype.reduce.call(arguments,function(t,n){return n&&t.push(e.promise(n)),t},t=[]),t.length?i.all(t):i.reject(new TypeError("no arguments given for promiseAll call"))},s=function(t,e,n){return t instanceof Error?n(t):e(t)},a=Object.create(null),e.stream=function(t){var e;return(e=a[t])||(a[t]=e=n.fromEventTarget(this,t)),e},t=e.emit,e.emit=function(n){var r;return u[n]||(r=arguments.length>2?Array.prototype.slice.call(arguments,1):arguments[1],u[n]=new i(s.bind(null,r))),t.apply(e,arguments)},e},e.exports=o(),e.exports.create=function(){return o()},e.exports.Promise=i,e.exports.Bacon=n},{baconjs:2,bluebird:5,eventemitter2:39}],2:[function(e,n){(function(e){(function(){var r,i,o,s,u,a,c,l,f,h,p,d,v,_,y,m,g,b,w,j,E,k,F,A,T,x,P,R,C,O,S,I,M,U,V,H,L,D,B,W,N,z,q,$,Q,G,K,Z,J,X,Y,te,ee,ne,re,ie,oe,se,ue,ae,ce,le,fe,he,pe,de,ve,_e,ye=[].slice,me={}.hasOwnProperty,ge=function(t,e){function n(){this.constructor=t}for(var r in e)me.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},be=function(t,e){return function(){return t.apply(e,arguments)}};r={toString:function(){return"Bacon"}},r.version="0.7.22",v=("undefined"!=typeof e&&null!==e?e:this).Error,r.fromBinder=function(t,e){return null==e&&(e=ve.id),new d(U(r,"fromBinder",t,e),function(n){var i,o,s;return s=!1,i=function(){return"undefined"!=typeof o&&null!==o?(s||o(),s=!0):void 0},o=t(function(){var t,s,u,a,c,l;for(t=1<=arguments.length?ye.call(arguments,0):[],a=e.apply(null,t),z(a)&&ve.last(a)instanceof p||(a=[a]),u=r.more,c=0,l=a.length;l>c;c++)if(s=a[c],u=n(s=ae(s)),u===r.noMore||s.isEnd())return null!=o?i():r.scheduler.setTimeout(i,0),u;return u}),i})},r.$={asEventStream:function(t,e,n){var i;return $(e)&&(i=[e,null],n=i[0],e=i[1]),pe(this.selector||this,"asEventStream",t,r.fromBinder(function(n){return function(r){return n.on(t,e,r),function(){return n.off(t,e,r)}}}(this),n))}},null!=(_e="undefined"!=typeof jQuery&&null!==jQuery?jQuery:"undefined"!=typeof Zepto&&null!==Zepto?Zepto:null)&&(_e.fn.asEventStream=r.$.asEventStream),r.fromEventTarget=function(t,e,n){var i,o,s,u,a,c;return i=null!=(s=t.addEventListener)?s:null!=(u=t.addListener)?u:t.bind,o=null!=(a=t.removeEventListener)?a:null!=(c=t.removeListener)?c:t.unbind,pe(r,"fromEventTarget",t,e,r.fromBinder(function(n){return i.call(t,e,n),function(){return o.call(t,e,n)}},n))},r.fromPromise=function(t,e){return pe(r,"fromPromise",t,r.fromBinder(function(n){return t.then(n,function(t){return n(new h(t))}),function(){return e&&"function"==typeof t.abort?t.abort():void 0}},function(t){return[t,V()]}))},r.noMore=["<no-more>"],r.more=["<more>"],r.later=function(t,e){return pe(r,"later",t,e,r.sequentially(t,[e]))},r.sequentially=function(t,e){var n;return n=0,pe(r,"sequentially",t,e,r.fromPoll(t,function(){var t;return t=e[n++],n<e.length?t:n===e.length?[t,V()]:V()}))},r.repeatedly=function(t,e){var n;return n=0,pe(r,"repeatedly",t,e,r.fromPoll(t,function(){return e[n++%e.length]}))},r.spy=function(t){return se.push(t)},se=[],oe=function(t){var e,n,r,i;if(se.length&&!oe.running)try{for(oe.running=!0,i=[],n=0,r=se.length;r>n;n++)e=se[n],i.push(e(t));return i}finally{delete oe.running}},de=function(t){return function(){var e,n,r,i;return r=arguments[0],e=2<=arguments.length?ye.call(arguments,1):[],"object"==typeof r&&e.length&&(n=r,i=e[0],r=function(){return n[i].apply(n,arguments)},e=e.slice(1)),t.apply(null,[r].concat(ye.call(e)))}},K=function(t,e){return de(function(){var n,i,o;return i=arguments[0],n=2<=arguments.length?ye.call(arguments,1):[],o=re(e,[function(t,e){return i.apply(null,ye.call(t).concat([e]))}]),pe.apply(null,[r,t,i].concat(ye.call(n),[r.combineAsArray(n).flatMap(o)]))})},r.fromCallback=K("fromCallback",function(){var t,e;return e=arguments[0],t=2<=arguments.length?ye.call(arguments,1):[],r.fromBinder(function(n){return Z(e,t)(n),ne},function(t){return[t,V()]})}),r.fromNodeCallback=K("fromNodeCallback",function(){var t,e;return e=arguments[0],t=2<=arguments.length?ye.call(arguments,1):[],r.fromBinder(function(n){return Z(e,t)(n),ne},function(t,e){return t?[new h(t),V()]:[e,V()]})}),r.fromPoll=function(t,e){return pe(r,"fromPoll",t,e,r.fromBinder(function(e){var n;return n=r.scheduler.setInterval(e,t),function(){return r.scheduler.clearInterval(n)}},e))},r.interval=function(t,e){return null==e&&(e={}),pe(r,"interval",t,e,r.fromPoll(t,function(){return ee(e)}))},r.constant=function(t){return new b(U(r,"constant",t),function(e){return e(N(t)),e(V()),ne})},r.never=function(){return pe(r,"never",r.fromArray([]))},r.once=function(t){return pe(r,"once",t,r.fromArray([t]))},r.fromArray=function(t){return T(t),t=O(t),new d(U(r,"fromArray",t),function(e){var n,i,o;for(i=!1,n=r.more;n!==r.noMore&&!i;)ve.empty(t)?(e(V()),n=r.noMore):(o=t.shift(),n=e(ae(o)));return function(){return i=!0}})},r.mergeAll=function(){var t;return t=1<=arguments.length?ye.call(arguments,0):[],z(t[0])&&(t=t[0]),t.length?new d(U.apply(null,[r,"mergeAll"].concat(ye.call(t))),function(e){var n,i,o;return n=0,o=function(i){return function(o){return i.subscribeInternal(function(i){var s;return i.isEnd()?(n++,n===t.length?e(V()):r.more):(s=e(i),s===r.noMore&&o(),s)})}},i=ve.map(o,t),S.apply(null,i)}):r.never()},r.zipAsArray=function(){var t;return t=1<=arguments.length?ye.call(arguments,0):[],z(t[0])&&(t=t[0]),pe.apply(null,[r,"zipAsArray"].concat(ye.call(t),[r.zipWith(t,function(){var t;return t=1<=arguments.length?ye.call(arguments,0):[]})]))},r.zipWith=function(){var t,e,n;return t=arguments[0],e=2<=arguments.length?ye.call(arguments,1):[],$(t)||(n=[t,e[0]],e=n[0],t=n[1]),e=ve.map(function(t){return t.toEventStream()},e),pe.apply(null,[r,"zipWith",t].concat(ye.call(e),[r.when(e,t)]))},r.groupSimultaneous=function(){var t,e,n;return n=1<=arguments.length?ye.call(arguments,0):[],1===n.length&&z(n[0])&&(n=n[0]),e=function(){var e,r,o;for(o=[],e=0,r=n.length;r>e;e++)t=n[e],o.push(new i(t));return o}(),pe.apply(null,[r,"groupSimultaneous"].concat(ye.call(n),[r.when(e,function(){var t;return t=1<=arguments.length?ye.call(arguments,0):[]})]))},r.combineAsArray=function(){var t,e,n,i,o,s,u;for(o=1<=arguments.length?ye.call(arguments,0):[],1===o.length&&z(o[0])&&(o=o[0]),t=s=0,u=o.length;u>s;t=++s)i=o[t],Q(i)||(o[t]=r.constant(i));return o.length?(n=function(){var t,n,r;for(r=[],t=0,n=o.length;n>t;t++)e=o[t],r.push(new E(e,!0,e.subscribeInternal));return r}(),pe.apply(null,[r,"combineAsArray"].concat(ye.call(o),[r.when(n,function(){var t;return t=1<=arguments.length?ye.call(arguments,0):[]}).toProperty()]))):r.constant([])},r.onValues=function(){var t,e,n;return e=2<=arguments.length?ye.call(arguments,0,n=arguments.length-1):(n=0,[]),t=arguments[n++],r.combineAsArray(e).onValues(t)},r.combineWith=function(){var t,e;return t=arguments[0],e=2<=arguments.length?ye.call(arguments,1):[],pe.apply(null,[r,"combineWith",t].concat(ye.call(e),[r.combineAsArray(e).map(function(e){return t.apply(null,e)})]))},r.combineTemplate=function(t){var e,n,i,o,s,u,a,c,l,f;return a=[],f=[],u=function(t){return t[t.length-1]},l=function(t,e,n){return u(t)[e]=n},e=function(t,e){return function(n,r){return l(n,t,r[e])}},s=function(t,e){return function(n){return l(n,t,e)}},c=function(t){return z(t)?[]:{}},i=function(t,n){var r,i;return Q(n)?(f.push(n),a.push(e(t,f.length-1))):n!==Object(n)||"function"==typeof n||n instanceof RegExp||n instanceof Date?a.push(s(t,n)):(i=function(t){return function(e){var r;return r=c(n),l(e,t,r),e.push(r)}},r=function(t){return t.pop()},a.push(i(t)),o(n),a.push(r))},o=function(t){return ve.each(t,i)},o(t),n=function(e){var n,r,i,o,s;for(i=c(t),n=[i],o=0,s=a.length;s>o;o++)(r=a[o])(n,e);return i},pe(r,"combineTemplate",t,r.combineAsArray(f).map(n))},r.retry=function(t){var e,n,i,o,s,u;if(!$(t.source))throw new v("'source' option has to be a function");return u=t.source,o=t.retries||0,i=t.maxRetries||o,e=t.delay||function(){return 0},n=t.isRetryable||function(){return!0},s=function(t){var s,a;return a={source:u,retries:o-1,maxRetries:i,delay:e,isRetryable:n},s=function(){return r.retry(a)},r.later(e(t)).filter(!1).concat(r.once().flatMap(s))},pe(r,"retry",t,u().flatMapError(function(t){return n(t)&&o>0?s({error:t,retriesDone:i-o}):r.once(new r.Error(t))}))},H=0,p=function(){function t(){this.id=++H}return t.prototype.isEvent=function(){return!0},t.prototype.isEnd=function(){return!1},t.prototype.isInitial=function(){return!1},t.prototype.isNext=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.hasValue=function(){return!1},t.prototype.filter=function(){return!0},t.prototype.inspect=function(){return this.toString()},t.prototype.log=function(){return this.toString()},t}(),y=function(t){function e(t){e.__super__.constructor.call(this),this.value=$(t)?ve.cached(t):ve.always(t)}return ge(e,t),e.prototype.isNext=function(){return!0},e.prototype.hasValue=function(){return!0},e.prototype.fmap=function(t){var e;return e=this.value,this.apply(function(){return t(e())})},e.prototype.apply=function(t){return new e(t)},e.prototype.filter=function(t){return t(this.value())},e.prototype.toString=function(){return ve.toString(this.value())},e.prototype.log=function(){return this.value()},e}(p),_=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,t),e.prototype.isInitial=function(){return!0},e.prototype.isNext=function(){return!1},e.prototype.apply=function(t){return new e(t)},e.prototype.toNext=function(){return new y(this.value)},e}(y),f=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,t),e.prototype.isEnd=function(){return!0},e.prototype.fmap=function(){return this},e.prototype.apply=function(){return this},e.prototype.toString=function(){return"<end>"},e}(p),h=function(t){function e(t){this.error=t}return ge(e,t),e.prototype.isError=function(){return!0},e.prototype.fmap=function(){return this},e.prototype.apply=function(){return this},e.prototype.toString=function(){return"<error> "+ve.toString(this.error)},e}(p),W=0,g=function(){function t(t){this.flatMapError=be(this.flatMapError,this),this.id=++W,pe(t,this),this.initialDesc=this.desc}return t.prototype.onValue=function(){var t;return t=J(arguments),this.subscribe(function(e){return e.hasValue()?t(e.value()):void 0})},t.prototype.onValues=function(t){return this.onValue(function(e){return t.apply(null,e)})},t.prototype.onError=function(){var t;return t=J(arguments),this.subscribe(function(e){return e.isError()?t(e.error):void 0})},t.prototype.onEnd=function(){var t;return t=J(arguments),this.subscribe(function(e){return e.isEnd()?t():void 0})},t.prototype.errors=function(){return pe(this,"errors",this.filter(function(){return!1}))},t.prototype.filter=function(){var t,e;return e=arguments[0],t=2<=arguments.length?ye.call(arguments,1):[],M(this,e,t,function(t){return pe(this,"filter",t,this.withHandler(function(e){return e.filter(t)?this.push(e):r.more}))})},t.prototype.takeWhile=function(){var t,e;return e=arguments[0],t=2<=arguments.length?ye.call(arguments,1):[],M(this,e,t,function(t){return pe(this,"takeWhile",t,this.withHandler(function(e){return e.filter(t)?this.push(e):(this.push(V()),r.noMore)}))})},t.prototype.endOnError=function(){var t,e;return e=arguments[0],t=2<=arguments.length?ye.call(arguments,1):[],null==e&&(e=!0),M(this,e,t,function(t){return pe(this,"endOnError",this.withHandler(function(e){return e.isError()&&t(e.error)?(this.push(e),this.push(V())):this.push(e)}))})},t.prototype.take=function(t){return 0>=t?r.never():pe(this,"take",t,this.withHandler(function(e){return e.hasValue()?(t--,t>0?this.push(e):(0===t&&this.push(e),this.push(V()),r.noMore)):this.push(e)}))},t.prototype.map=function(){var t,e;return e=arguments[0],t=2<=arguments.length?ye.call(arguments,1):[],e instanceof b?e.sampledBy(this,B):M(this,e,t,function(t){return pe(this,"map",t,this.withHandler(function(e){return this.push(e.fmap(t))}))})},t.prototype.mapError=function(){var t;return t=J(arguments),pe(this,"mapError",t,this.withHandler(function(e){return this.push(e.isError()?ee(t(e.error)):e)}))},t.prototype.mapEnd=function(){var t;return t=J(arguments),pe(this,"mapEnd",t,this.withHandler(function(e){return e.isEnd()?(this.push(ee(t(e))),this.push(V()),r.noMore):this.push(e)}))},t.prototype.doAction=function(){var t;return t=J(arguments),pe(this,"doAction",t,this.withHandler(function(e){return e.hasValue()&&t(e.value()),this.push(e)}))},t.prototype.skip=function(t){return pe(this,"skip",t,this.withHandler(function(e){return e.hasValue()&&t>0?(t--,r.more):this.push(e)}))},t.prototype.skipDuplicates=function(t){return null==t&&(t=function(t,e){return t===e}),pe(this,"skipDuplicates",this.withStateMachine(m,function(e,n){return n.hasValue()?n.isInitial()||e===m||!t(e.get(),n.value())?[new j(n.value()),[n]]:[e,[]]:[e,[n]]}))},t.prototype.skipErrors=function(){return pe(this,"skipErrors",this.withHandler(function(t){return t.isError()?r.more:this.push(t)}))},t.prototype.withStateMachine=function(t,e){var n;return n=t,pe(this,"withStateMachine",t,e,this.withHandler(function(t){var i,o,s,u,a,c,l;for(i=e(n,t),o=i[0],u=i[1],n=o,a=r.more,c=0,l=u.length;l>c;c++)if(s=u[c],a=this.push(s),a===r.noMore)return a;return a}))},t.prototype.scan=function(t,e,n){var i,o,s,u;return null==n&&(n={}),o=ue(e),e=n.lazyF?o:function(t,e){return o(t(),e())},i=fe(t).map(function(t){return ve.always(t)}),u=function(t){return function(o){var u,a,c,l;return u=!1,l=ne,a=r.more,c=function(){return u?void 0:i.forEach(function(t){return u=!0,a=o(new _(t)),a===r.noMore?(l(),l=ne):void 0})},l=t.subscribeInternal(function(t){var s,l;return t.hasValue()?u&&t.isInitial()?r.more:(t.isInitial()||c(),u=!0,l=i.getOrElse(function(){return void 0}),s=ve.cached(function(){return e(l,t.value)}),i=new j(s),n.eager&&s(),o(t.apply(s))):(t.isEnd()&&(a=c()),a!==r.noMore?o(t):void 0)}),k.whenDoneWith(s,c),l}}(this),s=new b(U(this,"scan",t,e),u)},t.prototype.fold=function(t,e,n){return pe(this,"fold",t,e,this.scan(t,e,n).sampledBy(this.filter(!1).mapEnd().toProperty()))},t.prototype.zip=function(t,e){return null==e&&(e=Array),pe(this,"zip",t,r.zipWith([this,t],e))},t.prototype.diff=function(t,e){return e=ue(e),pe(this,"diff",t,e,this.scan([t],function(t,n){return[n,e(t[0],n)]}).filter(function(t){return 2===t.length}).map(function(t){return t[1]}))},t.prototype.flatMap=function(){return D(this,te(arguments))},t.prototype.flatMapFirst=function(){return D(this,te(arguments),!0)},t.prototype.flatMapWithConcurrencyLimit=function(){var t,e;return e=arguments[0],t=2<=arguments.length?ye.call(arguments,1):[],pe.apply(null,[this,"flatMapWithConcurrencyLimit",e].concat(ye.call(t),[D(this,te(t),!1,e)]))},t.prototype.flatMapLatest=function(){var t,e;return t=te(arguments),e=this.toEventStream(),pe(this,"flatMapLatest",t,e.flatMap(function(n){return Y(t(n)).takeUntil(e)}))},t.prototype.flatMapError=function(t){return pe(this,"flatMapError",t,this.mapError(function(t){return new r.Error(t)}).flatMap(function(e){return e instanceof r.Error?t(e.error):r.once(e)}))},t.prototype.flatMapConcat=function(){return pe.apply(null,[this,"flatMapConcat"].concat(ye.call(arguments),[this.flatMapWithConcurrencyLimit.apply(this,[1].concat(ye.call(arguments)))]))},t.prototype.bufferingThrottle=function(t){return pe(this,"bufferingThrottle",t,this.flatMapConcat(function(e){return r.once(e).concat(r.later(t).filter(!1))}))},t.prototype.not=function(){return pe(this,"not",this.map(function(t){return!t}))},t.prototype.log=function(){var t;return t=1<=arguments.length?ye.call(arguments,0):[],this.subscribe(function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log.apply(console,ye.call(t).concat([e.log()])):void 0}),this},t.prototype.slidingWindow=function(t,e){return null==e&&(e=0),pe(this,"slidingWindow",t,e,this.scan([],function(e,n){return e.concat([n]).slice(-t)}).filter(function(t){return t.length>=e}))},t.prototype.combine=function(t,e){var n;return n=ue(e),pe(this,"combine",t,e,r.combineAsArray(this,t).map(function(t){return n(t[0],t[1])}))},t.prototype.decode=function(t){return pe(this,"decode",t,this.combine(r.combineTemplate(t),function(t,e){return e[t]}))},t.prototype.awaiting=function(t){return pe(this,"awaiting",t,r.groupSimultaneous(this,t).map(function(t){var e,n;return e=t[0],n=t[1],0===n.length}).toProperty(!1).skipDuplicates())},t.prototype.name=function(t){return this._name=t,this},t.prototype.withDescription=function(){return U.apply(null,arguments).apply(this)},t.prototype.dependsOn=function(t){return a.dependsOn(this,t)},t.prototype.toString=function(){return this._name?this._name:this.desc.toString()},t.prototype.internalDeps=function(){return this.initialDesc.deps()},t}(),g.prototype.reduce=g.prototype.fold,g.prototype.assign=g.prototype.onValue,g.prototype.inspect=g.prototype.toString,D=function(t,e,n,i){var o,u;return o=[t],u=new d(U(t,"flatMap"+(n?"First":""),e),function(u){var c,l,f,h,p;return f=new s,h=[],p=function(t){var n;return n=Y(e(t.value())),o.push(n),a.invalidate(),f.add(function(t,e){return n.subscribeInternal(function(i){var s;return i.isEnd()?(ve.remove(n,o),a.invalidate(),l(),c(e),r.noMore):(i instanceof _&&(i=i.toNext()),s=u(i),s===r.noMore&&t(),s)})})},l=function(){var t;return t=h.shift(),t?p(t):void 0},c=function(t){return t(),f.empty()?u(V()):void 0},f.add(function(e,o){return t.subscribeInternal(function(t){return t.isEnd()?c(o):t.isError()?u(t):n&&f.count()>1?r.more:f.unsubscribed?r.noMore:i&&f.count()>i?h.push(t):p(t)})}),f.unsubscribe}),u.internalDeps=function(){return o},u},d=function(t){function e(t,n){var r;$(t)&&(n=t,t=[]),e.__super__.constructor.call(this,t),P(n),r=new l(n),this.subscribeInternal=r.subscribe,this.subscribe=k.wrappedSubscribe(this),this.hasSubscribers=r.hasSubscribers,oe(this)}return ge(e,t),e.prototype.delay=function(t){return pe(this,"delay",t,this.flatMap(function(e){return r.later(t,e)}))},e.prototype.debounce=function(t){return pe(this,"debounce",t,this.flatMapLatest(function(e){return r.later(t,e)}))},e.prototype.debounceImmediate=function(t){return pe(this,"debounceImmediate",t,this.flatMapFirst(function(e){return r.once(e).concat(r.later(t).filter(!1))}))},e.prototype.throttle=function(t){return pe(this,"throttle",t,this.bufferWithTime(t).map(function(t){return t[t.length-1]}))},e.prototype.bufferWithTime=function(t){return pe(this,"bufferWithTime",t,this.bufferWithTimeOrCount(t,Number.MAX_VALUE))},e.prototype.bufferWithCount=function(t){return pe(this,"bufferWithCount",t,this.bufferWithTimeOrCount(void 0,t))},e.prototype.bufferWithTimeOrCount=function(t,e){var n;return n=function(n){return n.values.length===e?n.flush():void 0!==t?n.schedule():void 0},pe(this,"bufferWithTimeOrCount",t,e,this.buffer(t,n,n))},e.prototype.buffer=function(t,e,n){var i,o,s;return null==e&&(e=function(){}),null==n&&(n=function(){}),i={scheduled:!1,end:null,values:[],flush:function(){var t;if(this.scheduled=!1,this.values.length>0){if(t=this.push(ee(this.values)),this.values=[],null!=this.end)return this.push(this.end);if(t!==r.noMore)return n(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){return this.scheduled?void 0:(this.scheduled=!0,t(function(t){return function(){return t.flush()}}(this)))}},s=r.more,$(t)||(o=t,t=function(t){return r.scheduler.setTimeout(t,o)}),pe(this,"buffer",this.withHandler(function(t){return i.push=this.push,t.isError()?s=this.push(t):t.isEnd()?(i.end=t,i.scheduled||i.flush()):(i.values.push(t.value()),e(i)),s}))},e.prototype.merge=function(t){var e;return x(t),e=this,pe(e,"merge",t,r.mergeAll(this,t))},e.prototype.toProperty=function(t){return 0===arguments.length&&(t=m),pe(this,"toProperty",t,this.scan(t,G,{lazyF:!0}))},e.prototype.toEventStream=function(){return this},e.prototype.sampledBy=function(t,e){return pe(this,"sampledBy",t,e,this.toProperty().sampledBy(t,e))},e.prototype.concat=function(t){var n;return n=this,new e(U(n,"concat",t),function(e){var r,i;return i=ne,r=n.subscribeInternal(function(n){return n.isEnd()?i=t.subscribeInternal(e):e(n)}),function(){return r(),i()}})},e.prototype.takeUntil=function(t){var e;return e={},pe(this,"takeUntil",t,r.groupSimultaneous(this.mapEnd(e),t.skipErrors()).withHandler(function(n){var i,o,s,u,a,c;if(n.hasValue()){if(c=n.value(),i=c[0],t=c[1],t.length)return this.push(V());for(o=r.more,u=0,a=i.length;a>u;u++)s=i[u],o=this.push(s===e?V():ee(s));return o}return this.push(n)}))},e.prototype.skipUntil=function(t){var e;return e=t.take(1).map(!0).toProperty(!1),pe(this,"skipUntil",t,this.filter(e))},e.prototype.skipWhile=function(){var t,e,n;return e=arguments[0],t=2<=arguments.length?ye.call(arguments,1):[],n=!1,M(this,e,t,function(t){return pe(this,"skipWhile",t,this.withHandler(function(e){return!n&&e.hasValue()&&t(e.value())?r.more:(e.hasValue()&&(n=!0),this.push(e))}))})},e.prototype.holdWhen=function(t){var e,n,i;return i=t.startWith(!1),n=i.filter(function(t){return!t}),e=i.filter(ve.id),pe(this,"holdWhen",t,this.filter(!1).merge(i.flatMapConcat(function(t){return function(i){return i?t.scan([],function(t,e){return t.concat(e)},{eager:!0}).sampledBy(n).take(1).flatMap(r.fromArray):t.takeUntil(e)}}(this))))},e.prototype.startWith=function(t){return pe(this,"startWith",t,r.once(t).concat(this))},e.prototype.withHandler=function(t){var n;return n=new l(this.subscribeInternal,t),new e(U(this,"withHandler",t),n.subscribe)},e}(g),b=function(t){function e(t,n,r){$(t)&&(r=n,n=t,t=[]),e.__super__.constructor.call(this,t),P(n),this.subscribeInternal=r===!0?n:new w(this,n,r).subscribe,this.subscribe=k.wrappedSubscribe(this),oe(this)}return ge(e,t),e.prototype.sampledBy=function(t,n){var i,o,s,u,a;return null!=n?n=ue(n):(i=!0,n=function(t){return t()}),a=new E(this,!1,this.subscribeInternal,i),s=new E(t,!0,t.subscribeInternal,i),u=r.when([a,s],n),o=t instanceof e?u.toProperty():u,pe(this,"sampledBy",t,n,o)},e.prototype.sample=function(t){return pe(this,"sample",t,this.sampledBy(r.interval(t,{})))},e.prototype.changes=function(){return new d(U(this,"changes"),function(t){return function(e){return t.subscribeInternal(function(t){return t.isInitial()?void 0:e(t)})}}(this))},e.prototype.withHandler=function(t){return new e(U(this,"withHandler",t),this.subscribeInternal,t)},e.prototype.toProperty=function(){return R(arguments),this},e.prototype.toEventStream=function(){return new d(U(this,"toEventStream"),function(t){return function(e){return t.subscribeInternal(function(t){return t.isInitial()&&(t=t.toNext()),e(t)})}}(this))},e.prototype.and=function(t){return pe(this,"and",t,this.combine(t,function(t,e){return t&&e}))},e.prototype.or=function(t){return pe(this,"or",t,this.combine(t,function(t,e){return t||e}))},e.prototype.delay=function(t){return this.delayChanges("delay",t,function(e){return e.delay(t)})},e.prototype.debounce=function(t){return this.delayChanges("debounce",t,function(e){return e.debounce(t)})},e.prototype.throttle=function(t){return this.delayChanges("throttle",t,function(e){return e.throttle(t)})},e.prototype.delayChanges=function(){var t,e,n;return t=2<=arguments.length?ye.call(arguments,0,n=arguments.length-1):(n=0,[]),e=arguments[n++],pe.apply(null,[this].concat(ye.call(t),[F(this,e(this.changes()))]))},e.prototype.takeUntil=function(t){var e;return e=this.changes().takeUntil(t),pe(this,"takeUntil",t,F(this,e))},e.prototype.startWith=function(t){return pe(this,"startWith",t,this.scan(t,function(t,e){return e}))},e.prototype.bufferingThrottle=function(){var t;return(t=e.__super__.bufferingThrottle.apply(this,arguments)).bufferingThrottle.apply(t,arguments).toProperty()},e}(g),M=function(t,e,n,r){var i;return e instanceof b?(i=e.sampledBy(t,function(t,e){return[t,e]}),r.apply(i,[function(t){var e,n;return e=t[0],n=t[1],e}]).map(function(t){var e,n;return e=t[0],n=t[1]})):(e=Z(e,n),r.apply(t,[e]))},F=function(t,e){var n;return n=new d(U(t,"justInitValue"),function(e){var i,o;return o=null,i=t.subscribeInternal(function(t){return t.hasValue()&&(o=t),r.noMore}),k.whenDoneWith(n,function(){return null!=o&&e(o),e(V())}),i}),n.concat(e).toProperty()},l=function(){function t(t,e){var n,i,o,s,u,a,c,l,f,h;null==t&&(t=function(){return ne}),l=[],a=[],u=!1,i=!1,this.hasSubscribers=function(){return l.length>0},o=null,f=ne,c=function(t){return l=ve.without(t,l)},h=null,n=function(){var t,e,n,r,i;if(null!=h){for(e=h,h=null,i=[],n=0,r=e.length;r>n;n++)t=e[n],i.push(t());return i}},s=function(t){var e,i,s,h,p,d;if(u)return a.push(t),r.more;if(t!==o){t.isError()&&(o=t),s=!1;try{for(u=!0,h=l,p=0,d=h.length;d>p;p++)i=h[p],e=i.sink(t),(e===r.noMore||t.isEnd())&&c(i);s=!0}finally{u=!1,s||(a=[])}for(s=!0;a.length;)t=a.shift(),this.push(t);return n(t),this.hasSubscribers()?r.more:(f(),r.noMore)}},this.push=function(t){return function(e){return k.inTransaction(e,t,s,[e])}}(this),null==e&&(e=function(t){return this.push(t)}),this.handleEvent=function(t){return function(n){return n.isEnd()&&(i=!0),e.apply(t,[n])}}(this),this.subscribe=function(e){return function(n){var r,o;return i?(n(V()),ne):(P(n),r={sink:n},l.push(r),1===l.length&&(o=t(e.handleEvent),f=function(){return o(),f=ne}),P(f),function(){return c(r),e.hasSubscribers()?void 0:f()})}}(this)}return t}(),w=function(t){function e(t,n,i){var o,s,u,a;e.__super__.constructor.call(this,n,i),o=m,s=void 0,a=this.push,n=this.subscribe,u=!1,this.push=function(t){return function(e){return e.isEnd()&&(u=!0),e.hasValue()&&(o=new j(e),s=k.currentEventId()),a.apply(t,[e])}}(this),this.subscribe=function(e){return function(i){var a,c,l,f,h;return c=!1,f=r.more,l=function(){return f===r.noMore?ne:u?(i(V()),ne):n.apply(this,[i])},o.isDefined&&(e.hasSubscribers()||u)?(a=k.currentEventId(),h=s,!u&&h&&a&&a!==h?(k.whenDoneWith(t,function(){return s===h?i(N(o.get().value())):void 0}),l()):(k.inTransaction(void 0,e,function(){return f=i(N(o.get().value()))},[]),l())):l()}}(this)}return ge(e,t),e}(l),o=function(t){function e(){var t,n,i,o,s,u,a,c;i=void 0,u=[],t=!1,n=function(t){return function(e){return e.isEnd()?(c(t),r.noMore):i(e)}},a=function(){var t,e,n,r;for(r=[],e=0,n=u.length;n>e;e++)t=u[e],r.push("function"==typeof t.unsub?t.unsub():void 0);return r},s=function(t){return t.unsub=t.input.subscribeInternal(n(t.input))},c=function(t){var e,n,r,i;for(e=r=0,i=u.length;i>r;e=++r)if(n=u[e],n.input===t)return"function"==typeof n.unsub&&n.unsub(),void u.splice(e,1)},o=function(t){var e,n,r,o;for(i=t,o=O(u),n=0,r=o.length;r>n;n++)e=o[n],s(e);return a},e.__super__.constructor.call(this,U(r,"Bus"),o),this.plug=function(e){var n;if(!t)return n={input:e},u.push(n),null!=i&&s(n),function(){return c(e)}},this.push=function(t){return"function"==typeof i?i(ee(t)):void 0},this.error=function(t){return"function"==typeof i?i(new h(t)):void 0},this.end=function(){return t=!0,a(),"function"==typeof i?i(V()):void 0}}return ge(e,t),e}(d),E=function(){function t(t,e,n,r){this.obs=t,this.sync=e,this.subscribe=n,this.lazy=null!=r?r:!1,this.queue=[],null==this.subscribe&&(this.subscribe=this.obs.subscribeInternal)}return t.prototype.toString=function(){return this.obs.toString.call(this)},t.prototype.markEnded=function(){return this.ended=!0},t.prototype.consume=function(){return this.lazy?ve.always(this.queue[0]):this.queue[0]},t.prototype.push=function(t){return this.queue=[t]},t.prototype.mayHave=function(){return!0},t.prototype.hasAtLeast=function(){return this.queue.length},t.prototype.flatten=!0,t}(),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,t),e.prototype.consume=function(){return this.queue.shift()},e.prototype.push=function(t){return this.queue.push(t)},e.prototype.mayHave=function(t){return!this.ended||this.queue.length>=t},e.prototype.hasAtLeast=function(t){return this.queue.length>=t},e.prototype.flatten=!1,e}(E),i=function(t){function e(t){this.obs=t,e.__super__.constructor.call(this,this.obs,!0,this.obs.subscribeInternal)}return ge(e,t),e.prototype.consume=function(){var t;return t=this.queue,this.queue=[],function(){return t}},e.prototype.push=function(t){return this.queue.push(t())},e.prototype.hasAtLeast=function(){return!0},e}(E),E.isTrigger=function(t){return t instanceof E?t.sync:t instanceof d},E.fromObservable=function(t){return t instanceof E?t:t instanceof b?new E(t,!1):new u(t,!0)},U=function(){var t,e,n;return e=arguments[0],n=arguments[1],t=3<=arguments.length?ye.call(arguments,2):[],(e||n)instanceof c?e||n:new c(e,n,t)},L=function(t){return z(t)?ve.flatMap(L,t):Q(t)?[t]:t instanceof E?[t.obs]:[]},c=function(){function t(t,e,n){this.context=t,this.method=e,this.args=n,this.cached=null}return t.prototype.deps=function(){return this.cached||(this.cached=L([this.context].concat(this.args)))},t.prototype.apply=function(t){return t.desc=this,t},t.prototype.toString=function(){return ve.toString(this.context)+"."+ve.toString(this.method)+"("+ve.map(ve.toString,this.args)+")"},t}(),pe=function(){var t,e,n;return t=2<=arguments.length?ye.call(arguments,0,n=arguments.length-1):(n=0,[]),e=arguments[n++],U.apply(null,t).apply(e)},r.when=function(){var t,e,n,i,o,s,u,a,c,l,f,h,p,v,_,y,m,g,b,w;if(l=1<=arguments.length?ye.call(arguments,0):[],0===l.length)return r.never();for(o=l.length,_="when: expecting arguments in the form (Observable+,function)+",A(_,o%2===0),p=[],c=[],e=0;o>e;){for(a=ve.toArray(l[e]),t=l[e+1],u={f:$(t)?t:function(){return t},ixs:[]},v=!1,y=0,g=a.length;g>y;y++){for(h=a[y],n=ve.indexOf(p,h),v||(v=E.isTrigger(h)),0>n&&(p.push(h),n=p.length-1),w=u.ixs,m=0,b=w.length;b>m;m++)i=w[m],i.index===n&&i.count++;u.ixs.push({index:n,count:1})}A("At least one EventStream required",v||!a.length),a.length>0&&c.push(u),e+=2}return p.length?(p=ve.map(E.fromObservable,p),s=ve.any(p,function(t){return t.flatten})&&I(ve.map(function(t){return t.obs},p)),f=new d(U.apply(null,[r,"when"].concat(ye.call(l))),function(t){var n,i,o,u,a,l,d;return d=[],o=!1,u=function(t){var n,r,i;for(i=t.ixs,n=0,r=i.length;r>n;n++)if(e=i[n],!p[e.index].hasAtLeast(e.count))return!1;return!0},i=function(t){return!t.sync||t.ended},n=function(t){var n,r,i;for(i=t.ixs,n=0,r=i.length;r>n;n++)if(e=i[n],!p[e.index].mayHave(e.count))return!0},a=function(t){return!t.source.flatten},l=function(l){return function(h){var v,_,y;return _=function(){return k.whenDoneWith(f,v)},y=function(){var n,i,o,s,l,f;if(!(d.length>0))return r.more;for(o=r.more,s=d.pop(),l=0,f=c.length;f>l;l++)if(i=c[l],u(i))return n=function(){var t,n,r,o;for(r=i.ixs,o=[],t=0,n=r.length;n>t;t++)e=r[t],o.push(p[e.index].consume());return o}(),o=t(s.e.apply(function(){var t,e;return e=function(){var e,r,i;for(i=[],e=0,r=n.length;r>e;e++)t=n[e],i.push(t());
return i}(),i.f.apply(i,e)})),d.length&&(d=ve.filter(a,d)),o===r.noMore?o:y()},v=function(){var e;return e=y(),o&&(o=!1,(ve.all(p,i)||ve.all(c,n))&&(e=r.noMore,t(V()))),e===r.noMore&&h(),e},l.subscribe(function(e){var n;return e.isEnd()?(o=!0,l.markEnded(),_()):e.isError()?n=t(e):(l.push(e.value),l.sync&&(d.push({source:l,e:e}),s||k.hasWaiters()?_():v())),n===r.noMore&&h(),n||r.more})}},S.apply(null,function(){var t,e,n;for(n=[],t=0,e=p.length;e>t;t++)h=p[t],n.push(l(h));return n}())})):r.never()},I=function(t,e){var n;return null==e&&(e=[]),n=function(t){var i;return r._.contains(e,t)?!0:(i=t.internalDeps(),i.length?(e.push(t),r._.any(i,n)):(e.push(t),!1))},r._.any(t,n)},r.update=function(){var t,e,n,i;for(e=arguments[0],i=2<=arguments.length?ye.call(arguments,1):[],n=function(t){return function(){var e;return e=1<=arguments.length?ye.call(arguments,0):[],function(n){return t.apply(null,[n].concat(e))}}},t=i.length-1;t>0;)i[t]instanceof Function||(i[t]=function(t){return function(){return t}}(i[t])),i[t]=n(i[t]),t-=2;return pe.apply(null,[r,"update",e].concat(ye.call(i),[r.when.apply(r,i).scan(e,function(t,e){return e(t)})]))},S=function(){var t;return t=1<=arguments.length?ye.call(arguments,0):[],new s(t).unsubscribe},s=function(){function t(t){var e,n,r;for(null==t&&(t=[]),this.unsubscribe=be(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[],n=0,r=t.length;r>n;n++)e=t[n],this.add(e)}return t.prototype.add=function(t){var e,n,r;if(!this.unsubscribed)return e=!1,n=ne,this.starting.push(t),r=function(r){return function(){return r.unsubscribed?void 0:(e=!0,r.remove(n),ve.remove(t,r.starting))}}(this),n=t(this.unsubscribe,r),this.unsubscribed||e||this.subscriptions.push(n),ve.remove(t,this.starting),n},t.prototype.remove=function(t){return this.unsubscribed?void 0:void 0!==ve.remove(t,this.subscriptions)?t():void 0},t.prototype.unsubscribe=function(){var t,e,n,r;if(!this.unsubscribed){for(this.unsubscribed=!0,r=this.subscriptions,e=0,n=r.length;n>e;e++)(t=r[e])();return this.subscriptions=[],this.starting=[]}},t.prototype.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},t.prototype.empty=function(){return 0===this.count()},t}(),r.CompositeUnsubscribe=s,j=function(){function t(t){this.value=t}return t.prototype.getOrElse=function(){return this.value},t.prototype.get=function(){return this.value},t.prototype.filter=function(e){return e(this.value)?new t(this.value):m},t.prototype.map=function(e){return new t(e(this.value))},t.prototype.forEach=function(t){return t(this.value)},t.prototype.isDefined=!0,t.prototype.toArray=function(){return[this.value]},t.prototype.inspect=function(){return"Some("+this.value+")"},t.prototype.toString=function(){return this.inspect()},t}(),m={getOrElse:function(t){return t},filter:function(){return m},map:function(){return m},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},a=function(){var t,e,n,r;return n={},e=function(e,r){var i;return i=n[e.id],i||(i=n[e.id]={},t(e,e)),i[r.id]},t=function(e,r){var i,o,s,u,a;for(u=r.internalDeps(),a=[],o=0,s=u.length;s>o;o++)i=u[o],n[e.id][i.id]=!0,a.push(t(e,i));return a},r=function(){return n={}},{invalidate:r,dependsOn:e}}(),k=function(){var t,e,n,i,o,s,u,c,l,f,h,p,d;return f=void 0,h=[],e=[],t=function(t){return f?e.push(t):t()},c=function(t){return!ve.any(h,function(e){return a.dependsOn(t.obs,e.obs)})},p=function(t,e){return f?h.push({obs:t,f:e}):e()},i=function(){for(;!c(h[0]);)h.push(h.shift());return h.shift()},o=function(){var t;for(t=[];h.length;)t.push(i().f());return t},l=a.invalidate,u=function(t,n,r,i){var s,u,a,c;if(f)return r.apply(n,i);f=t;try{s=r.apply(n,i),o()}finally{for(f=void 0;e.length;)for(u=e,e=[],a=0,c=u.length;c>a;a++)(r=u[a])();l()}return s},n=function(){return f?f.id:void 0},d=function(e){return function(n){var i,o,s;return s=!1,i=function(){},o=function(){return s=!0,i()},i=e.subscribeInternal(function(e){return t(function(){var t;return s||(t=n(e),t!==r.noMore)?void 0:o()})}),o}},s=function(){return h.length>0},{whenDoneWith:p,hasWaiters:s,inTransaction:u,currentEventId:n,wrappedSubscribe:d}}(),r.EventStream=d,r.Property=b,r.Observable=g,r.Bus=o,r.Initial=_,r.Next=y,r.End=f,r.Error=h,ne=function(){},G=function(t,e){return e()},B=function(t){return t},N=function(t){return new _(ve.always(t))},ee=function(t){return new y(ve.always(t))},V=function(){return new f},ae=function(t){return t instanceof p?t:ee(t)},O=function(t){return t.slice(0)},A=function(t,e){if(!e)throw new v(t)},x=function(t){if(!(t instanceof d))throw new v("not an EventStream : "+t)},P=function(t){return A("not a function : "+t,$(t))},$=function(t){return"function"==typeof t},z=function(t){return t instanceof Array},Q=function(t){return t instanceof g},T=function(t){if(!z(t))throw new v("not an array : "+t)},R=function(t){return A("no arguments supported",0===t.length)},C=function(t){if("string"!=typeof t)throw new v("not a string : "+t)},re=function(t,e){return function(){var n;return n=1<=arguments.length?ye.call(arguments,0):[],t.apply(null,e.concat(n))}},te=function(t){return 1===t.length&&Q(t[0])?ve.always(t[0]):J(t)},J=function(t){return t=Array.prototype.slice.call(t),X.apply(null,t)},X=de(function(){var t,e;return e=arguments[0],t=2<=arguments.length?ye.call(arguments,1):[],$(e)?t.length?re(e,t):e:q(e)?ce(e,t):ve.always(e)}),Z=function(t,e){return X.apply(null,[t].concat(ye.call(e)))},Y=function(t){return Q(t)?t:r.once(t)},q=function(t){return"string"==typeof t&&t.length>1&&"."===t.charAt(0)},r.isFieldKey=q,ce=function(t,e){var n,r;return r=t.slice(1).split("."),n=ve.map(he(e),r),function(e){var r,i;for(r=0,i=n.length;i>r;r++)t=n[r],e=t(e);return e}},he=function(t){return function(e){return function(n){var r;return null==n?void 0:(r=n[e],$(r)?r.apply(n,t):r)}}},le=function(t){return t.slice(1)},ue=function(t){var e;return $(t)?t:q(t)?(e=le(t),function(t,n){return t[e](n)}):A("not a function or a field key: "+t,!1)},fe=function(t){return t instanceof j||t===m?t:new j(t)},ve={indexOf:Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){var n,r,i,o;for(n=i=0,o=t.length;o>i;n=++i)if(r=t[n],e===r)return n;return-1},indexWhere:function(t,e){var n,r,i,o;for(n=i=0,o=t.length;o>i;n=++i)if(r=t[n],e(r))return n;return-1},head:function(t){return t[0]},always:function(t){return function(){return t}},negate:function(t){return function(e){return!t(e)}},empty:function(t){return 0===t.length},tail:function(t){return t.slice(1,t.length)},filter:function(t,e){var n,r,i,o;for(n=[],i=0,o=e.length;o>i;i++)r=e[i],t(r)&&n.push(r);return n},map:function(t,e){var n,r,i,o;for(o=[],r=0,i=e.length;i>r;r++)n=e[r],o.push(t(n));return o},each:function(t,e){var n,r,i;i=[];for(n in t)r=t[n],i.push(e(n,r));return i},toArray:function(t){return z(t)?t:[t]},contains:function(t,e){return-1!==ve.indexOf(t,e)},id:function(t){return t},last:function(t){return t[t.length-1]},all:function(t,e){var n,r,i;for(null==e&&(e=ve.id),r=0,i=t.length;i>r;r++)if(n=t[r],!e(n))return!1;return!0},any:function(t,e){var n,r,i;for(null==e&&(e=ve.id),r=0,i=t.length;i>r;r++)if(n=t[r],e(n))return!0;return!1},without:function(t,e){return ve.filter(function(e){return e!==t},e)},remove:function(t,e){var n;return n=ve.indexOf(e,t),n>=0?e.splice(n,1):void 0},fold:function(t,e,n){var r,i,o;for(i=0,o=t.length;o>i;i++)r=t[i],e=n(e,r);return e},flatMap:function(t,e){return ve.fold(e,[],function(e,n){return e.concat(t(n))})},cached:function(t){var e;return e=m,function(){return e===m&&(e=t(),t=null),e}},toString:function(t){var e,n,r,i;try{return ie++,null==t?"undefined":$(t)?"function":z(t)?ie>5?"[..]":"["+ve.map(ve.toString,t).toString()+"]":null!=(null!=t?t.toString:void 0)&&t.toString!==Object.prototype.toString?t.toString():"object"==typeof t?ie>5?"{..}":(n=function(){var n;n=[];for(r in t)me.call(t,r)&&(i=function(){try{return t[r]}catch(n){return e=n}}(),n.push(ve.toString(r)+":"+ve.toString(i)));return n}(),"{"+n+"}"):t}finally{ie--}}},ie=0,r._=ve,r.scheduler={setTimeout:function(t,e){return setTimeout(t,e)},setInterval:function(t,e){return setInterval(t,e)},clearInterval:function(t){return clearInterval(t)},now:function(){return(new Date).getTime()}},"undefined"!=typeof t&&null!==t&&null!=t.amd?(t([],function(){return r}),this.Bacon=r):"undefined"!=typeof n&&null!==n?(n.exports=r,r.Bacon=r):this.Bacon=r}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,e){"use strict";e.exports=function(t){function e(t){var e=new n(t),r=e.promise();return r.isRejected()?r:(e.setHowMany(1),e.setUnwrap(),e.init(),r)}var n=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},{}],4:[function(t,e){(function(n){"use strict";function r(){this._isTickUsed=!1,this._schedule=i,this._length=0,this._lateBuffer=new o(16),this._functionBuffer=new o(65536);var t=this;this.consumeFunctionBuffer=function(){t._consumeFunctionBuffer()}}var i=t("./schedule.js"),o=t("./queue.js"),s=t("./util.js").errorObj,u=t("./util.js").tryCatch1,a="undefined"!=typeof n?n:void 0;r.prototype.haveItemsQueued=function(){return this._length>0},r.prototype.invokeLater=function(t,e,n){void 0===a||null==a.domain||t.domain||(t=a.domain.bind(t)),this._lateBuffer.push(t,e,n),this._queueTick()},r.prototype.invoke=function(t,e,n){void 0===a||null==a.domain||t.domain||(t=a.domain.bind(t));var r=this._functionBuffer;r.push(t,e,n),this._length=r.length(),this._queueTick()},r.prototype._consumeFunctionBuffer=function(){for(var t=this._functionBuffer;t.length()>0;){var e=t.shift(),n=t.shift(),r=t.shift();e.call(n,r)}this._reset(),this._consumeLateBuffer()},r.prototype._consumeLateBuffer=function(){for(var t=this._lateBuffer;t.length()>0;){var e=t.shift(),n=t.shift(),r=t.shift(),i=u(e,n,r);if(i===s){if(this._queueTick(),null==e.domain)throw i.e;e.domain.emit("error",i.e)}}},r.prototype._queueTick=function(){this._isTickUsed||(this._schedule(this.consumeFunctionBuffer),this._isTickUsed=!0)},r.prototype._reset=function(){this._isTickUsed=!1,this._length=0},e.exports=new r}).call(this,t("_process"))},{"./queue.js":27,"./schedule.js":30,"./util.js":37,_process:38}],5:[function(t,e){"use strict";var n=t("./promise.js")();e.exports=n},{"./promise.js":22}],6:[function(t,e){"use strict";var n=Object.create;if(n){var r=n(null),i=n(null);r[" size"]=i[" size"]=0}e.exports=function(e){function n(t){return new Function("obj","                                             \n        'use strict'                                                         \n        var len = this.length;                                               \n        switch(len) {                                                        \n            case 1: return obj.methodName(this[0]);                          \n            case 2: return obj.methodName(this[0], this[1]);                 \n            case 3: return obj.methodName(this[0], this[1], this[2]);        \n            case 0: return obj.methodName();                                 \n            default: return obj.methodName.apply(obj, this);                 \n        }                                                                    \n        ".replace(/methodName/g,t))}function o(t){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",t))}function s(t,e,n){var r=n[t];if("function"!=typeof r){if(!d(t))return null;if(r=e(t),n[t]=r,n[" size"]++,n[" size"]>512){for(var i=Object.keys(n),o=0;256>o;++o)delete n[i[o]];n[" size"]=i.length-256}}return r}function u(t){return s(t,n,r)}function a(t){return s(t,o,i)}function c(t){return t[this.pop()].apply(t,this)}function l(t){return t[this]}function f(t){return t[this]}var h=t("./util.js"),p=h.canEvaluate,d=h.isIdentifier;e.prototype.call=function(t){for(var e=arguments.length,n=new Array(e-1),r=1;e>r;++r)n[r-1]=arguments[r];if(p){var i=u(t);if(null!==i)return this._then(i,void 0,void 0,n,void 0)}return n.push(t),this._then(c,void 0,void 0,n,void 0)},e.prototype.get=function(t){var e,n="number"==typeof t;if(n)e=f;else if(p){var r=a(t);e=null!==r?r:l}else e=l;return this._then(e,void 0,void 0,t,void 0)}}},{"./util.js":37}],7:[function(t,e){"use strict";e.exports=function(e,n){var r=t("./errors.js"),i=r.canAttach,o=t("./async.js"),s=r.CancellationError;e.prototype._cancel=function(t){if(!this.isCancellable())return this;for(var e,n=this;void 0!==(e=n._cancellationParent)&&e.isCancellable();)n=e;n._attachExtraTrace(t),n._rejectUnchecked(t)},e.prototype.cancel=function(t){return this.isCancellable()?(t=void 0!==t?i(t)?t:new Error(t+""):new s,o.invokeLater(this._cancel,this,t),this):this},e.prototype.cancellable=function(){return this._cancellable()?this:(this._setCancellable(),this._cancellationParent=void 0,this)},e.prototype.uncancellable=function(){var t=new e(n);return t._propagateFrom(this,6),t._follow(this),t._unsetCancellable(),t},e.prototype.fork=function(t,e,n){var r=this._then(t,e,n,void 0,void 0);return r._setCancellable(),r._cancellationParent=void 0,r}}},{"./async.js":4,"./errors.js":12}],8:[function(t,e){"use strict";e.exports=function(){function e(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t.toString();var r=/\[object [a-zA-Z0-9$_]+\]/;if(r.test(e))try{var i=JSON.stringify(t);e=i}catch(o){}0===e.length&&(e="(empty array)")}return"(<"+n(e)+">, no stack trace)"}function n(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function r(t,e){this.captureStackTrace(r,e)}var i=t("./util.js").inherits,o=t("./es5.js").defineProperty,s=new RegExp("\\b(?:[a-zA-Z0-9.]+\\$_\\w+|tryCatch(?:1|2|3|4|Apply)|new \\w*PromiseArray|\\w*PromiseArray\\.\\w*PromiseArray|setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|process._tickCallback|nextTick|Async\\$\\w+)\\b"),u=null,a=null;i(r,Error),r.prototype.captureStackTrace=function(t,e){c(this,t,e)},r.possiblyUnhandledRejection=function(t){if("object"==typeof console){var e;if("object"==typeof t||"function"==typeof t){var n=t.stack;e="Possibly unhandled "+a(n,t)}else e="Possibly unhandled "+String(t);"function"==typeof console.error||"object"==typeof console.error?console.error(e):("function"==typeof console.log||"object"==typeof console.log)&&console.log(e)}},r.combine=function(t,e){for(var n=t.length-1,r=e.length-1;r>=0;--r){var i=e[r];if(t[n]!==i)break;t.pop(),n--}t.push("From previous event:");for(var o=t.concat(e),a=[],r=0,c=o.length;c>r;++r)s.test(o[r])&&u.test(o[r])||r>0&&!u.test(o[r])&&"From previous event:"!==o[r]||a.push(o[r]);return a},r.protectErrorMessageNewlines=function(t){for(var e=0;e<t.length&&!u.test(t[e]);++e);if(!(1>=e)){for(var n=[],r=0;e>r;++r)n.push(t.shift());t.unshift(n.join("\x00"))}},r.isSupported=function(){return"function"==typeof c};var c=function l(){if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){u=/^\s*at\s*/,a=function(t,n){return"string"==typeof t?t:void 0!==n.name&&void 0!==n.message?n.name+". "+n.message:e(n)};var t=Error.captureStackTrace;return function(e,n){t(e,n)}}var n=new Error;if("string"==typeof n.stack&&"function"==typeof"".startsWith&&n.stack.startsWith("stackDetection@")&&"stackDetection"===l.name){o(Error,"stackTraceLimit",{writable:!0,enumerable:!1,configurable:!1,value:25}),u=/@/;var r=/[@\n]/;return a=function(t,n){return"string"==typeof t?n.name+". "+n.message+"\n"+t:void 0!==n.name&&void 0!==n.message?n.name+". "+n.message:e(n)},function(t){for(var e=(new Error).stack,n=e.split(r),i=n.length,o="",s=0;i>s;s+=2)o+=n[s],o+="@",o+=n[s+1],o+="\n";t.stack=o}}return a=function(t,n){return"string"==typeof t?t:"object"!=typeof n&&"function"!=typeof n||void 0===n.name||void 0===n.message?e(n):n.name+". "+n.message},null}();return r}},{"./es5.js":14,"./util.js":37}],9:[function(t,e){"use strict";e.exports=function(e){function n(t,e,n){this._instances=t,this._callback=e,this._promise=n}function r(t,e){var n={},r=s(t,n,e);if(r===u)return r;var i=a(n);return i.length?(u.e=new c("Catch filter must inherit from Error or be a simple predicate function"),u):r}var i=t("./util.js"),o=t("./errors.js"),s=i.tryCatch1,u=i.errorObj,a=t("./es5.js").keys,c=o.TypeError;return n.prototype.doFilter=function(t){for(var n=this._callback,i=this._promise,a=i._boundTo,c=0,l=this._instances.length;l>c;++c){var f=this._instances[c],h=f===Error||null!=f&&f.prototype instanceof Error;if(h&&t instanceof f){var p=s(n,a,t);return p===u?(e.e=p.e,e):p}if("function"==typeof f&&!h){var d=r(f,t);if(d===u){var v=o.canAttach(u.e)?u.e:new Error(u.e+"");this._promise._attachExtraTrace(v),t=u.e;break}if(d){var p=s(n,a,t);return p===u?(e.e=p.e,e):p}}}return e.e=t,e},n}},{"./errors.js":12,"./es5.js":14,"./util.js":37}],10:[function(t,e){"use strict";var n=t("./util.js"),r=n.isPrimitive,i=n.wrapsPrimitiveReceiver;e.exports=function(t){var e=function(){return this},n=function(){throw this},o=function(t,e){return 1===e?function(){throw t}:2===e?function(){return t}:void 0};t.prototype["return"]=t.prototype.thenReturn=function(t){return i&&r(t)?this._then(o(t,2),void 0,void 0,void 0,void 0):this._then(e,void 0,void 0,t,void 0)},t.prototype["throw"]=t.prototype.thenThrow=function(t){return i&&r(t)?this._then(o(t,1),void 0,void 0,void 0,void 0):this._then(n,void 0,void 0,t,void 0)}}},{"./util.js":37}],11:[function(t,e){"use strict";e.exports=function(t,e){var n=t.reduce;t.prototype.each=function(t){return n(this,t,null,e)},t.each=function(t,r){return n(t,r,null,e)}}},{}],12:[function(t,e){"use strict";function n(t){try{p(t,"isOperational",!0)}catch(e){}}function r(t){return null==t?!1:t instanceof u||t.isOperational===!0}function i(t){return t instanceof Error}function o(t){return i(t)}function s(t,e){function n(r){return this instanceof n?(this.message="string"==typeof r?r:e,this.name=t,void(Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new n(r)}return h(n,Error),n}function u(t){this.name="OperationalError",this.message=t,this.cause=t,this.isOperational=!0,t instanceof Error?(this.message=t.message,this.stack=t.stack):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var a,c,l=t("./es5.js").freeze,f=t("./util.js"),h=f.inherits,p=f.notEnumerableProp,d=s("CancellationError","cancellation error"),v=s("TimeoutError","timeout error"),_=s("AggregateError","aggregate error");try{a=TypeError,c=RangeError}catch(y){a=s("TypeError","type error"),c=s("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),g=0;g<m.length;++g)"function"==typeof Array.prototype[m[g]]&&(_.prototype[m[g]]=Array.prototype[m[g]]);_.prototype.length=0,_.prototype.isOperational=!0;var b=0;_.prototype.toString=function(){var t=Array(4*b+1).join(" "),e="\n"+t+"AggregateError of:\n";b++,t=Array(4*b+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];r=i.join("\n"),e+=r+"\n"}return b--,e},h(u,Error);var w="__BluebirdErrorTypes__",j=Error[w];j||(j=l({CancellationError:d,TimeoutError:v,OperationalError:u,RejectionError:u,AggregateError:_}),p(Error,w,j)),e.exports={Error:Error,TypeError:a,RangeError:c,CancellationError:j.CancellationError,OperationalError:j.OperationalError,TimeoutError:j.TimeoutError,AggregateError:j.AggregateError,originatesFromRejection:r,markAsOriginatingFromRejection:n,canAttach:o}},{"./es5.js":14,"./util.js":37}],13:[function(t,e){"use strict";e.exports=function(e){function n(t){var n=new r(t),i=e.rejected(n),o=i._peekContext();return null!=o&&o._attachExtraTrace(n),i}var r=t("./errors.js").TypeError;return n}},{"./errors.js":12}],14:[function(t,e){var n=function(){"use strict";return void 0===this}();if(n)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,keys:Object.keys,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n};else{var r={}.hasOwnProperty,i={}.toString,o={}.constructor.prototype,s=function(t){var e=[];for(var n in t)r.call(t,n)&&e.push(n);return e},u=function(t,e,n){return t[e]=n.value,t},a=function(t){return t},c=function(t){try{return Object(t).constructor.prototype}catch(e){return o}},l=function(t){try{return"[object Array]"===i.call(t)}catch(e){return!1}};e.exports={isArray:l,keys:s,defineProperty:u,freeze:a,getPrototypeOf:c,isES5:n}}},{}],15:[function(t,e){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],16:[function(t,e){"use strict";e.exports=function(e,n,r){function i(){return this}function o(){throw this}function s(t){return function(){return t}}function u(t){return function(){throw t}}function a(t,e,n){var r;return r=h&&p(e)?n?s(e):u(e):n?i:o,t._then(r,d,void 0,e,void 0)}function c(t){var i=this.promise,o=this.handler,s=i._isBound()?o.call(i._boundTo):o();if(void 0!==s){var u=r(s,void 0);if(u instanceof e)return a(u,t,i.isFulfilled())}return i.isRejected()?(n.e=t,n):t}function l(t){var n=this.promise,i=this.handler,o=n._isBound()?i.call(n._boundTo,t):i(t);if(void 0!==o){var s=r(o,void 0);if(s instanceof e)return a(s,t,!0)}return t}var f=t("./util.js"),h=f.wrapsPrimitiveReceiver,p=f.isPrimitive,d=f.thrower;e.prototype._passThroughHandler=function(t,e){if("function"!=typeof t)return this.then();var n={promise:this,handler:t};return this._then(e?c:l,e?c:void 0,void 0,n,void 0)},e.prototype.lastly=e.prototype["finally"]=function(t){return this._passThroughHandler(t,!0)},e.prototype.tap=function(t){return this._passThroughHandler(t,!1)}}},{"./util.js":37}],17:[function(t,e){"use strict";e.exports=function(e,n,r,i){function o(t,n){for(var r=f,s=e,u=n.length,a=0;u>a;++a){var c=h(n[a],void 0,t);if(c===r)return s.reject(r.e);var l=i(c,o);if(l instanceof s)return l}return null}function s(t,n,i){var o=this._promise=new e(r);o._setTrace(void 0),this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(p):p}var u=t("./errors.js"),a=u.TypeError,c=t("./util.js").deprecated,l=t("./util.js"),f=l.errorObj,h=l.tryCatch1,p=[];s.prototype.promise=function(){return this._promise},s.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},s.prototype._continue=function(t){if(t===f){this._generator=void 0;var n=u.canAttach(t.e)?t.e:new Error(t.e+"");return this._promise._attachExtraTrace(n),void this._promise._reject(t.e,n)}var r=t.value;if(t.done===!0)this._generator=void 0,this._promise._tryFollow(r)||this._promise._fulfill(r);else{var s=i(r,void 0);if(!(s instanceof e)&&(s=o(s,this._yieldHandlers),null===s))return void this._throw(new a("A value was yielded that could not be treated as a promise"));s._then(this._next,this._throw,void 0,this,null)}},s.prototype._throw=function(t){u.canAttach(t)&&this._promise._attachExtraTrace(t),this._continue(h(this._generator["throw"],this._generator,t))},s.prototype._next=function(t){this._continue(h(this._generator.next,this._generator,t))},e.coroutine=function(t,e){if("function"!=typeof t)throw new a("generatorFunction must be a function");var n=Object(e).yieldHandler,r=s;return function(){var e=t.apply(this,arguments),i=new r(void 0,void 0,n);return i._generator=e,i._next(void 0),i.promise()}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new a("fn must be a function");p.push(t)},e.spawn=function(t){if(c("Promise.spawn is deprecated. Use Promise.coroutine instead."),"function"!=typeof t)return n("generatorFunction must be a function");var r=new s(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors.js":12,"./util.js":37}],18:[function(t,e){"use strict";e.exports=function(e,n,r,i){var o=t("./util.js"),s=o.canEvaluate,u=o.tryCatch1,a=o.errorObj;if(s){for(var c=function(t){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,t))},l=function(t){for(var e=[],n=1;t>=n;++n)e.push("holder.p"+n);return new Function("holder","                                      \n            'use strict';                                                    \n            var callback = holder.fn;                                        \n            return callback(values);                                         \n            ".replace(/values/g,e.join(", ")))},f=[],h=[void 0],p=1;5>=p;++p)f.push(c(p)),h.push(l(p));var d=function(t,e){this.p1=this.p2=this.p3=this.p4=this.p5=null,this.fn=e,this.total=t,this.now=0};d.prototype.callers=h,d.prototype.checkFulfillment=function(t){var e=this.now;e++;var n=this.total;if(e>=n){var r=this.callers[n],i=u(r,void 0,this);i===a?t._rejectUnchecked(i.e):t._tryFollow(i)||t._fulfillUnchecked(i)}else this.now=e}}e.join=function(){var t,o=arguments.length-1;if(o>0&&"function"==typeof arguments[o]&&(t=arguments[o],6>o&&s)){var u=new e(i);u._setTrace(void 0);for(var a=new d(o,t),c=u._reject,l=f,h=0;o>h;++h){var p=r(arguments[h],void 0);p instanceof e?p.isPending()?p._then(l[h],c,void 0,u,a):p.isFulfilled()?l[h].call(u,p._settledValue,a):(u._reject(p._settledValue),p._unsetRejectionIsUnhandled()):l[h].call(u,p,a)}return u}for(var v=arguments.length,_=new Array(v),y=0;v>y;++y)_[y]=arguments[y];var u=new n(_).promise();return void 0!==t?u.spread(t):u}}},{"./util.js":37}],19:[function(t,e){"use strict";e.exports=function(e,n,r,i,o){function s(t,e,n,r){this.constructor$(t),this._callback=e,this._preservedValues=r===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=n>=1?[]:h,this._init$(void 0,-2)}function u(t,e,n,r){var i="object"==typeof n&&null!==n?n.concurrency:0;return i="number"==typeof i&&isFinite(i)&&i>=1?i:0,new s(t,e,i,r)}var a=t("./util.js"),c=a.tryCatch3,l=a.errorObj,f={},h=[];a.inherits(s,n),s.prototype._init=function(){},s.prototype._promiseFulfilled=function(t,n){var r=this._values;if(null!==r){var o=this.length(),s=this._preservedValues,u=this._limit;if(r[n]===f){if(r[n]=t,u>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(u>=1&&this._inFlight>=u)return r[n]=t,void this._queue.push(n);null!==s&&(s[n]=t);var a=this._callback,h=this._promise._boundTo,p=c(a,h,t,n,o);if(p===l)return this._reject(p.e);var d=i(p,void 0);if(d instanceof e){if(d.isPending())return u>=1&&this._inFlight++,r[n]=f,d._proxyPromiseArray(this,n);if(!d.isFulfilled())return d._unsetRejectionIsUnhandled(),this._reject(d.reason());p=d.value()}r[n]=p}var v=++this._totalResolved;v>=o&&(null!==s?this._filter(r,s):this._resolve(r))}},s.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){var r=t.pop();this._promiseFulfilled(n[r],r)}},s.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,o=0;n>o;++o)t[o]&&(r[i++]=e[o]);r.length=i,this._resolve(r)},s.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return"function"!=typeof t?r("fn must be a function"):u(this,t,e,null).promise()},e.map=function(t,e,n,i){return"function"!=typeof e?r("fn must be a function"):u(t,e,n,i).promise()}}},{"./util.js":37}],20:[function(t,e){"use strict";e.exports=function(e){function n(t){throw t}function r(t,e){if(!s.isArray(t))return i(t,e);var r=s.tryCatchApply(this,[null].concat(t),e);r===l&&u.invokeLater(n,void 0,r.e)}function i(t,e){var r=this,i=void 0===t?c(r,e,null):a(r,e,null,t);i===l&&u.invokeLater(n,void 0,i.e)}function o(t,e){var r=this,i=c(r,e,t);i===l&&u.invokeLater(n,void 0,i.e)}var s=t("./util.js"),u=t("./async.js"),a=s.tryCatch2,c=s.tryCatch1,l=s.errorObj;e.prototype.nodeify=function(t,e){if("function"==typeof t){var n=i;void 0!==e&&Object(e).spread&&(n=r),this._then(n,o,void 0,t,this._boundTo)}return this}}},{"./async.js":4,"./util.js":37}],21:[function(t,e){"use strict";e.exports=function(e,n){var r=t("./util.js"),i=t("./async.js"),o=t("./errors.js"),s=r.tryCatch1,u=r.errorObj;e.prototype.progressed=function(t){return this._then(void 0,void 0,t,void 0,void 0)},e.prototype._progress=function(t){this._isFollowingOrFulfilledOrRejected()||this._progressUnchecked(t)},e.prototype._clearFirstHandlerData$Base=e.prototype._clearFirstHandlerData,e.prototype._clearFirstHandlerData=function(){this._clearFirstHandlerData$Base(),this._progressHandler0=void 0},e.prototype._progressHandlerAt=function(t){return 0===t?this._progressHandler0:this[(t<<2)+t-5+2]},e.prototype._doProgressWith=function(t){var n=t.value,r=t.handler,i=t.promise,a=t.receiver,c=s(r,a,n);if(c===u){if(null!=c.e&&"StopProgressPropagation"!==c.e.name){var l=o.canAttach(c.e)?c.e:new Error(c.e+"");i._attachExtraTrace(l),i._progress(c.e)}}else c instanceof e?c._then(i._progress,null,null,i,void 0):i._progress(c)},e.prototype._progressUnchecked=function(t){if(this.isPending())for(var r=this._length(),o=this._progress,s=0;r>s;s++){var u=this._progressHandlerAt(s),a=this._promiseAt(s);if(a instanceof e)"function"==typeof u?i.invoke(this._doProgressWith,this,{handler:u,promise:a,receiver:this._receiverAt(s),value:t}):i.invoke(o,a,t);else{var c=this._receiverAt(s);"function"==typeof u?u.call(c,t,a):c instanceof e&&c._isProxied()?c._progressUnchecked(t):c instanceof n&&c._promiseProgressed(t,a)}}}}},{"./async.js":4,"./errors.js":12,"./util.js":37}],22:[function(t,e){(function(n){"use strict";function r(t){try{Promise===t&&(Promise=i)}catch(e){}return t}var i;"undefined"!=typeof Promise&&(i=Promise),e.exports=function(){function e(t){if("function"!=typeof t)throw new j("the promise constructor requires a resolver function");if(this.constructor!==e)throw new j("the promise constructor cannot be invoked directly");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,this._boundTo=void 0,t!==a&&this._resolveFromResolver(t)}function i(t){return t[0]}var o=t("./util.js"),s=t("./async.js"),u=t("./errors.js"),a=function(){},c={},l={e:null},f=t("./thenables.js")(e,a),h=t("./promise_array.js")(e,a,f),p=t("./captured_trace.js")(),d=t("./catch_filter.js")(l),v=t("./promise_resolver.js"),_=o.isArray,y=o.errorObj,m=o.tryCatch1,g=o.tryCatch2,b=o.tryCatchApply,w=u.RangeError,j=u.TypeError,E=u.CancellationError,k=u.TimeoutError,F=u.OperationalError,A=u.originatesFromRejection,T=u.markAsOriginatingFromRejection,x=u.canAttach,P=o.thrower,R=t("./errors_api_rejection")(e),C=function(){return new j("circular promise resolution chain")};e.prototype.bind=function(t){var n=f(t,void 0),r=new e(a);if(n instanceof e){var o=n.then(function(t){r._setBoundTo(t)}),s=e.all([this,o]).then(i);r._follow(s)}else r._follow(this),r._setBoundTo(t);return r._propagateFrom(this,3),r},e.prototype.toString=function(){return"[object Promise]"},e.prototype.caught=e.prototype["catch"]=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),i=0;for(n=0;e-1>n;++n){var o=arguments[n];if("function"!=typeof o){var u=new j("A catch filter must be an error constructor or a filter function");return this._attachExtraTrace(u),void s.invoke(this._reject,this,u)}r[i++]=o}r.length=i,t=arguments[n],this._resetTrace();var a=new d(r,t,this);return this._then(void 0,a.doFilter,void 0,a,void 0)}return this._then(void 0,t,void 0,void 0,void 0)},e.prototype.then=function(t,e,n){return this._then(t,e,n,void 0,void 0)},e.prototype.done=function(t,e,n){var r=this._then(t,e,n,void 0,void 0);r._setIsFinal()},e.prototype.spread=function(t,e){return this._then(t,e,void 0,c,void 0)
},e.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},e.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this._settledValue,t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this._settledValue,t.isRejected=!0),t},e.prototype.all=function(){return new h(this).promise()},e.is=function(t){return t instanceof e},e.all=function(t){return new h(t).promise()},e.prototype.error=function(t){return this.caught(A,t)},e.prototype._resolveFromSyncValue=function(t){if(t===y)this._cleanValues(),this._setRejected(),this._settledValue=t.e,this._ensurePossibleRejectionHandled();else{var n=f(t,void 0);n instanceof e?this._follow(n):(this._cleanValues(),this._setFulfilled(),this._settledValue=t)}},e.method=function(t){if("function"!=typeof t)throw new j("fn must be a function");return function(){var n;switch(arguments.length){case 0:n=m(t,this,void 0);break;case 1:n=m(t,this,arguments[0]);break;case 2:n=g(t,this,arguments[0],arguments[1]);break;default:for(var r=arguments.length,i=new Array(r),o=0;r>o;++o)i[o]=arguments[o];n=b(t,i,this)}var s=new e(a);return s._setTrace(void 0),s._resolveFromSyncValue(n),s}},e.attempt=e["try"]=function(t,n,r){if("function"!=typeof t)return R("fn must be a function");var i=_(n)?b(t,n,r):m(t,r,n),o=new e(a);return o._setTrace(void 0),o._resolveFromSyncValue(i),o},e.defer=e.pending=function(){var t=new e(a);return t._setTrace(void 0),new v(t)},e.bind=function(t){var n=f(t,void 0),r=new e(a);if(r._setTrace(void 0),n instanceof e){var i=n.then(function(t){r._setBoundTo(t)});r._follow(i)}else r._setBoundTo(t),r._setFulfilled();return r},e.cast=function(t){var n=f(t,void 0);if(!(n instanceof e)){var r=n;n=new e(a),n._setTrace(void 0),n._setFulfilled(),n._cleanValues(),n._settledValue=r}return n},e.resolve=e.fulfilled=e.cast,e.reject=e.rejected=function(t){var n=new e(a);if(n._setTrace(void 0),T(t),n._cleanValues(),n._setRejected(),n._settledValue=t,!x(t)){var r=new Error(t+"");n._setCarriedStackTrace(r)}return n._ensurePossibleRejectionHandled(),n},e.onPossiblyUnhandledRejection=function(t){p.possiblyUnhandledRejection="function"==typeof t?t:void 0};var O;e.onUnhandledRejectionHandled=function(t){O="function"==typeof t?t:void 0};var S=!1||!("undefined"==typeof n||"string"!=typeof n.execPath||"object"!=typeof n.env||!n.env.BLUEBIRD_DEBUG&&"development"!==n.env.NODE_ENV);e.longStackTraces=function(){if(s.haveItemsQueued()&&S===!1)throw new Error("cannot enable long stack traces after promises have been created");S=p.isSupported()},e.hasLongStackTraces=function(){return S&&p.isSupported()},e.prototype._then=function(t,n,r,i,o){var u=void 0!==o,c=u?o:new e(a);if(!u){if(S){var l=this._peekContext()===this._traceParent;c._traceParent=l?this._traceParent:this}c._propagateFrom(this,7)}var f=this._addCallbacks(t,n,r,c,i);return this.isResolved()&&s.invoke(this._queueSettleAt,this,f),c},e.prototype._length=function(){return 262143&this._bitField},e.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},e.prototype._isFollowing=function(){return 536870912===(536870912&this._bitField)},e.prototype._setLength=function(t){this._bitField=-262144&this._bitField|262143&t},e.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},e.prototype._setRejected=function(){this._bitField=134217728|this._bitField},e.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},e.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},e.prototype._isFinal=function(){return(33554432&this._bitField)>0},e.prototype._cancellable=function(){return(67108864&this._bitField)>0},e.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},e.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},e.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},e.prototype._setCarriedStackTrace=function(t){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=t},e.prototype._unsetCarriedStackTrace=function(){this._bitField=-1048577&this._bitField,this._fulfillmentHandler0=void 0},e.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},e.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},e.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[(t<<2)+t-5+4];return this._isBound()&&void 0===e?this._boundTo:e},e.prototype._promiseAt=function(t){return 0===t?this._promise0:this[(t<<2)+t-5+3]},e.prototype._fulfillmentHandlerAt=function(t){return 0===t?this._fulfillmentHandler0:this[(t<<2)+t-5+0]},e.prototype._rejectionHandlerAt=function(t){return 0===t?this._rejectionHandler0:this[(t<<2)+t-5+1]},e.prototype._addCallbacks=function(t,e,n,r,i){var o=this._length();if(o>=262138&&(o=0,this._setLength(0)),0===o)this._promise0=r,void 0!==i&&(this._receiver0=i),"function"!=typeof t||this._isCarryingStackTrace()||(this._fulfillmentHandler0=t),"function"==typeof e&&(this._rejectionHandler0=e),"function"==typeof n&&(this._progressHandler0=n);else{var s=(o<<2)+o-5;this[s+3]=r,this[s+4]=i,this[s+0]="function"==typeof t?t:void 0,this[s+1]="function"==typeof e?e:void 0,this[s+2]="function"==typeof n?n:void 0}return this._setLength(o+1),o},e.prototype._setProxyHandlers=function(t,e){var n=this._length();if(n>=262138&&(n=0,this._setLength(0)),0===n)this._promise0=e,this._receiver0=t;else{var r=(n<<2)+n-5;this[r+3]=e,this[r+4]=t,this[r+0]=this[r+1]=this[r+2]=void 0}this._setLength(n+1)},e.prototype._proxyPromiseArray=function(t,e){this._setProxyHandlers(t,e)},e.prototype._proxyPromise=function(t){t._setProxied(),this._setProxyHandlers(t,-15)},e.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=8388608|this._bitField,this._boundTo=t):this._bitField=-8388609&this._bitField},e.prototype._isBound=function(){return 8388608===(8388608&this._bitField)},e.prototype._resolveFromResolver=function(t){function e(t){r._tryFollow(t)||r._fulfill(t)}function n(t){var e=x(t)?t:new Error(t+"");r._attachExtraTrace(e),T(t),r._reject(t,e===t?void 0:e)}var r=this;this._setTrace(void 0),this._pushContext();var i=g(t,void 0,e,n);if(this._popContext(),void 0!==i&&i===y){var o=i.e,s=x(o)?o:new Error(o+"");r._reject(o,s)}},e.prototype._spreadSlowCase=function(t,e,n,r){var i=new h(n).promise(),o=i._then(function(){return t.apply(r,arguments)},void 0,void 0,c,void 0);e._follow(o)},e.prototype._callSpread=function(t,n,r){var i=this._boundTo;if(_(r))for(var o=0,s=r.length;s>o;++o)if(f(r[o],void 0)instanceof e)return void this._spreadSlowCase(t,n,r,i);return n._pushContext(),b(t,r,i)},e.prototype._callHandler=function(t,e,n,r){var i;return e!==c||this.isRejected()?(n._pushContext(),i=m(t,e,r)):i=this._callSpread(t,n,r),n._popContext(),i},e.prototype._settlePromiseFromHandler=function(t,n,r,i){if(!(i instanceof e))return void t.call(n,r,i);var o=this._callHandler(t,n,i,r);if(!i._isFollowing())if(o===y||o===i||o===l){var s=o===i?C():o.e,u=x(s)?s:new Error(s+"");o!==l&&i._attachExtraTrace(u),i._rejectUnchecked(s,u)}else{var a=f(o,i);if(a instanceof e){if(a.isRejected()&&!a._isCarryingStackTrace()&&!x(a._settledValue)){var u=new Error(a._settledValue+"");i._attachExtraTrace(u),a._setCarriedStackTrace(u)}i._follow(a),i._propagateFrom(a,1)}else i._fulfillUnchecked(o)}},e.prototype._follow=function(t){this._setFollowing(),t.isPending()?(this._propagateFrom(t,1),t._proxyPromise(this)):t.isFulfilled()?this._fulfillUnchecked(t._settledValue):this._rejectUnchecked(t._settledValue,t._getCarriedStackTrace()),t._isRejectionUnhandled()&&t._unsetRejectionIsUnhandled(),S&&null==t._traceParent&&(t._traceParent=this)},e.prototype._tryFollow=function(t){if(this._isFollowingOrFulfilledOrRejected()||t===this)return!1;var n=f(t,void 0);return n instanceof e?(this._follow(n),!0):!1},e.prototype._resetTrace=function(){S&&(this._trace=new p(void 0===this._peekContext()))},e.prototype._setTrace=function(t){if(S){var e=this._peekContext();this._traceParent=e;var n=void 0===e;this._trace=void 0!==t&&t._traceParent===e?t._trace:new p(n)}return this},e.prototype._attachExtraTrace=function(t){if(S){var e=this,n=t.stack;n="string"==typeof n?n.split("\n"):[],p.protectErrorMessageNewlines(n);for(var r=1,i=1;null!=e&&null!=e._trace;)n=p.combine(n,e._trace.stack.split("\n")),e=e._traceParent,i++;var o=Error.stackTraceLimit||10,s=(o+r)*i,u=n.length;u>s&&(n.length=s),u>0&&(n[0]=n[0].split("\x00").join("\n")),t.stack=n.length<=r?"(No stack trace)":n.join("\n")}},e.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},e.prototype._propagateFrom=function(t,e){(1&e)>0&&t._cancellable()&&(this._setCancellable(),this._cancellationParent=t),(4&e)>0&&this._setBoundTo(t._boundTo),(2&e)>0&&this._setTrace(t)},e.prototype._fulfill=function(t){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(t)},e.prototype._reject=function(t,e){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(t,e)},e.prototype._settlePromiseAt=function(t){var n=this.isFulfilled()?this._fulfillmentHandlerAt(t):this._rejectionHandlerAt(t),r=this._settledValue,i=this._receiverAt(t),o=this._promiseAt(t);if("function"==typeof n)this._settlePromiseFromHandler(n,i,r,o);else{var s=!1,u=this.isFulfilled();void 0!==i&&(i instanceof e&&i._isProxied()?(i._unsetProxied(),u?i._fulfillUnchecked(r):i._rejectUnchecked(r,this._getCarriedStackTrace()),s=!0):i instanceof h&&(u?i._promiseFulfilled(r,o):i._promiseRejected(r,o),s=!0)),s||(u?o._fulfill(r):o._reject(r,this._getCarriedStackTrace()))}t>=4&&this._queueGC()},e.prototype._isProxied=function(){return 4194304===(4194304&this._bitField)},e.prototype._setProxied=function(){this._bitField=4194304|this._bitField},e.prototype._unsetProxied=function(){this._bitField=-4194305&this._bitField},e.prototype._isGcQueued=function(){return-1073741824===(-1073741824&this._bitField)},e.prototype._setGcQueued=function(){this._bitField=-1073741824|this._bitField},e.prototype._unsetGcQueued=function(){this._bitField=1073741823&this._bitField},e.prototype._queueGC=function(){this._isGcQueued()||(this._setGcQueued(),s.invokeLater(this._gc,this,void 0))},e.prototype._gc=function(){for(var t=5*this._length()-5,e=0;t>e;e++)delete this[e];this._clearFirstHandlerData(),this._setLength(0),this._unsetGcQueued()},e.prototype._clearFirstHandlerData=function(){this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0},e.prototype._queueSettleAt=function(t){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),s.invoke(this._settlePromiseAt,this,t)},e.prototype._fulfillUnchecked=function(t){if(this.isPending()){if(t===this){var e=C();return this._attachExtraTrace(e),this._rejectUnchecked(e,void 0)}this._cleanValues(),this._setFulfilled(),this._settledValue=t;var n=this._length();n>0&&s.invoke(this._settlePromises,this,n)}},e.prototype._rejectUncheckedCheckError=function(t){var e=x(t)?t:new Error(t+"");this._rejectUnchecked(t,e===t?void 0:e)},e.prototype._rejectUnchecked=function(t,e){if(this.isPending()){if(t===this){var n=C();return this._attachExtraTrace(n),this._rejectUnchecked(n)}if(this._cleanValues(),this._setRejected(),this._settledValue=t,this._isFinal())return void s.invokeLater(P,void 0,void 0===e?t:e);var r=this._length();void 0!==e&&this._setCarriedStackTrace(e),r>0?s.invoke(this._rejectPromises,this,null):this._ensurePossibleRejectionHandled()}},e.prototype._rejectPromises=function(){this._settlePromises(),this._unsetCarriedStackTrace()},e.prototype._settlePromises=function(){for(var t=this._length(),e=0;t>e;e++)this._settlePromiseAt(e)},e.prototype._ensurePossibleRejectionHandled=function(){this._setRejectionIsUnhandled(),void 0!==p.possiblyUnhandledRejection&&s.invokeLater(this._notifyUnhandledRejection,this,void 0)},e.prototype._notifyUnhandledRejectionIsHandled=function(){"function"==typeof O&&s.invokeLater(O,void 0,this)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue,e=this._getCarriedStackTrace();this._setUnhandledRejectionIsNotified(),void 0!==e&&(this._unsetCarriedStackTrace(),t=e),"function"==typeof p.possiblyUnhandledRejection&&p.possiblyUnhandledRejection(t,this)}};var I=[];return e.prototype._peekContext=function(){var t=I.length-1;return t>=0?I[t]:void 0},e.prototype._pushContext=function(){S&&I.push(this)},e.prototype._popContext=function(){S&&I.pop()},e.noConflict=function(){return r(e)},e.setScheduler=function(t){if("function"!=typeof t)throw new j("fn must be a function");s._schedule=t},p.isSupported()||(e.longStackTraces=function(){},S=!1),e._makeSelfResolutionError=C,t("./finally.js")(e,l,f),t("./direct_resolve.js")(e),t("./synchronous_inspection.js")(e),t("./join.js")(e,h,f,a),e.RangeError=w,e.CancellationError=E,e.TimeoutError=k,e.TypeError=j,e.OperationalError=F,e.RejectionError=F,e.AggregateError=u.AggregateError,o.toFastProperties(e),o.toFastProperties(e.prototype),e.Promise=e,t("./timers.js")(e,a,f),t("./race.js")(e,a,f),t("./call_get.js")(e),t("./generators.js")(e,R,a,f),t("./map.js")(e,h,R,f,a),t("./nodeify.js")(e),t("./promisify.js")(e,a),t("./props.js")(e,h,f),t("./reduce.js")(e,h,R,f,a),t("./settle.js")(e,h),t("./some.js")(e,h,R),t("./progress.js")(e,h),t("./cancel.js")(e,a),t("./filter.js")(e,a),t("./any.js")(e,h),t("./each.js")(e,a),t("./using.js")(e,R,f),e.prototype=e.prototype,e}}).call(this,t("_process"))},{"./any.js":3,"./async.js":4,"./call_get.js":6,"./cancel.js":7,"./captured_trace.js":8,"./catch_filter.js":9,"./direct_resolve.js":10,"./each.js":11,"./errors.js":12,"./errors_api_rejection":13,"./filter.js":15,"./finally.js":16,"./generators.js":17,"./join.js":18,"./map.js":19,"./nodeify.js":20,"./progress.js":21,"./promise_array.js":23,"./promise_resolver.js":24,"./promisify.js":25,"./props.js":26,"./race.js":28,"./reduce.js":29,"./settle.js":31,"./some.js":32,"./synchronous_inspection.js":33,"./thenables.js":34,"./timers.js":35,"./using.js":36,"./util.js":37,_process:38}],23:[function(t,e){"use strict";e.exports=function(e,n,r){function i(t){switch(t){case-1:return void 0;case-2:return[];case-3:return{}}}function o(t){var r=this._promise=new e(n),i=void 0;t instanceof e&&(i=t,r._propagateFrom(i,5)),r._setTrace(i),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var s=t("./errors.js").canAttach,u=t("./util.js"),a=u.isArray;return o.prototype.length=function(){return this._length},o.prototype.promise=function(){return this._promise},o.prototype._init=function c(t,n){var o=r(this._values,void 0);if(o instanceof e){if(this._values=o,o._setBoundTo(this._promise._boundTo),!o.isFulfilled())return o.isPending()?void o._then(c,this._reject,void 0,this,n):(o._unsetRejectionIsUnhandled(),void this._reject(o._settledValue));if(o=o._settledValue,!a(o)){var s=new e.TypeError("expecting an array, a promise or a thenable");return void this.__hardReject__(s)}}else if(!a(o)){var s=new e.TypeError("expecting an array, a promise or a thenable");return void this.__hardReject__(s)}if(0===o.length)return void(-5===n?this._resolveEmptyArray():this._resolve(i(n)));for(var u=this.getActualLength(o.length),l=u,f=this.shouldCopyValues()?new Array(u):this._values,h=!1,p=0;u>p;++p){var d=r(o[p],void 0);d instanceof e?d.isPending()?d._proxyPromiseArray(this,p):(d._unsetRejectionIsUnhandled(),h=!0):h=!0,f[p]=d}this._values=f,this._length=l,h&&this._scanDirectValues(u)},o.prototype._settlePromiseAt=function(t){var n=this._values[t];n instanceof e?n.isFulfilled()?this._promiseFulfilled(n._settledValue,t):n.isRejected()&&this._promiseRejected(n._settledValue,t):this._promiseFulfilled(n,t)},o.prototype._scanDirectValues=function(t){for(var e=0;t>e&&!this._isResolved();++e)this._settlePromiseAt(e)},o.prototype._isResolved=function(){return null===this._values},o.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},o.prototype.__hardReject__=o.prototype._reject=function(t){this._values=null;var e=s(t)?t:new Error(t+"");this._promise._attachExtraTrace(e),this._promise._reject(t,e)},o.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({index:e,value:t})},o.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)}},o.prototype._promiseRejected=function(t){this._isResolved()||(this._totalResolved++,this._reject(t))},o.prototype.shouldCopyValues=function(){return!0},o.prototype.getActualLength=function(t){return t},o}},{"./errors.js":12,"./util.js":37}],24:[function(t,e){"use strict";function n(t){return t instanceof Error&&p.getPrototypeOf(t)===Error.prototype}function r(t){var e;return e=n(t)?new l(t):t,a.markAsOriginatingFromRejection(e),e}function i(t){function e(e,n){if(null!==t){if(e){var i=r(u(e));t._attachExtraTrace(i),t._reject(i)}else if(arguments.length>2){for(var o=arguments.length,s=new Array(o-1),a=1;o>a;++a)s[a-1]=arguments[a];t._fulfill(s)}else t._fulfill(n);t=null}}return e}var o,s=t("./util.js"),u=s.maybeWrapAsError,a=t("./errors.js"),c=a.TimeoutError,l=a.OperationalError,f=t("./async.js"),h=s.haveGetters,p=t("./es5.js");if(o=h?function(t){this.promise=t}:function(t){this.promise=t,this.asCallback=i(t),this.callback=this.asCallback},h){var d={get:function(){return i(this.promise)}};p.defineProperty(o.prototype,"asCallback",d),p.defineProperty(o.prototype,"callback",d)}o._nodebackForPromise=i,o.prototype.toString=function(){return"[object PromiseResolver]"},o.prototype.resolve=o.prototype.fulfill=function(t){if(!(this instanceof o))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");var e=this.promise;e._tryFollow(t)||f.invoke(e._fulfill,e,t)},o.prototype.reject=function(t){if(!(this instanceof o))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");var e=this.promise;a.markAsOriginatingFromRejection(t);var n=a.canAttach(t)?t:new Error(t+"");e._attachExtraTrace(n),f.invoke(e._reject,e,t),n!==t&&f.invoke(this._setCarriedStackTrace,this,n)},o.prototype.progress=function(t){if(!(this instanceof o))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");f.invoke(this.promise._progress,this.promise,t)},o.prototype.cancel=function(){f.invoke(this.promise.cancel,this.promise,void 0)},o.prototype.timeout=function(){this.reject(new c("timeout"))},o.prototype.isResolved=function(){return this.promise.isResolved()},o.prototype.toJSON=function(){return this.promise.toJSON()},o.prototype._setCarriedStackTrace=function(t){this.promise.isRejected()&&this.promise._setCarriedStackTrace(t)},e.exports=o},{"./async.js":4,"./errors.js":12,"./es5.js":14,"./util.js":37}],25:[function(t,e){"use strict";e.exports=function(e,n){function r(t){return t.replace(/([$])/,"\\$")}function i(t){try{return t.__isPromisified__===!0}catch(e){return!1}}function o(t,e,n){var r=m.getDataPropertyOrDefault(t,e+n,A);return r?i(r):!1}function s(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var o=i.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new E("Cannot promisify an API that has normal methods with '"+e+"'-suffix")}}function u(t,e,n,r){for(var u=m.inheritedDataKeys(t),a=[],c=0;c<u.length;++c){var l=u[c],f=t[l];"function"!=typeof f||i(f)||o(t,l,e)||!r(l,f,t)||a.push(l,f)}return s(a,e,n),a}function a(t){for(var e=[t],n=Math.max(0,t-1-5),r=t-1;r>=n;--r)r!==t&&e.push(r);for(var r=t+1;5>=r;++r)e.push(r);return e}function c(t){return m.filledRange(t,"arguments[","]")}function l(t){return m.filledRange(t,"_arg","")}function f(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0}function h(t){return m.isIdentifier(t)?"."+t:"['"+t.replace(/(['\\])/g,"\\$1")+"']"}function p(t,r,i,o,s){function u(e){var n,i=c(e).join(", "),o=e>0?", ":"";return n="string"==typeof t?"                                                          \n                this.method(args, fn);                                       \n                break;                                                       \n            ".replace(".method",h(t)):r===y?"                                                         \n                callback.call(this, args, fn);                               \n                break;                                                       \n            ":void 0!==r?"                                                         \n                callback.call(receiver, args, fn);                           \n                break;                                                       \n            ":"                                                         \n                callback(args, fn);                                          \n                break;                                                       \n            ",n.replace("args",i).replace(", ",o)}function p(){for(var e="",n=0;n<v.length;++n)e+="case "+v[n]+":"+u(v[n]);var i;return i="string"==typeof t?"                                                  \n                this.property.apply(this, args);                             \n            ".replace(".property",h(t)):r===y?"                                                  \n                callback.apply(this, args);                                  \n            ":"                                                  \n                callback.apply(receiver, args);                              \n            ",e+="                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = fn;                                                    \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",i)}var d=Math.max(0,f(o)-1),v=a(d),_="string"==typeof i&&m.isIdentifier(i)?i+s:"promisified";return new Function("Promise","callback","receiver","withAppended","maybeWrapAsError","nodebackForPromise","INTERNAL","                                         \n        var ret = function FunctionName(Parameters) {                        \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._setTrace(void 0);                                       \n            var fn = nodebackForPromise(promise);                            \n            try {                                                            \n                switch(len) {                                                \n                    [CodeForSwitchCase]                                      \n                }                                                            \n            } catch (e) {                                                    \n                var wrapped = maybeWrapAsError(e);                           \n                promise._attachExtraTrace(wrapped);                          \n                promise._reject(wrapped);                                    \n            }                                                                \n            return promise;                                                  \n        };                                                                   \n        ret.__isPromisified__ = true;                                        \n        return ret;                                                          \n        ".replace("FunctionName",_).replace("Parameters",l(d)).replace("[CodeForSwitchCase]",p()))(e,t,r,b,w,g,n)}function d(t,r){function i(){var i=r;r===y&&(i=this),"string"==typeof t&&(t=i[t]);var o=new e(n);o._setTrace(void 0);var s=g(o);try{t.apply(i,b(arguments,s))}catch(u){var a=w(u);o._attachExtraTrace(a),o._reject(a)}return o}return i.__isPromisified__=!0,i}function v(t,e,n,i){for(var o=new RegExp(r(e)+"$"),s=u(t,e,o,n),a=0,c=s.length;c>a;a+=2){var l=s[a],f=s[a+1],h=l+e;t[h]=i===T?T(l,y,l,f,e):i(f)}return m.toFastProperties(t),t}function _(t,e){return T(t,e,void 0,t)}var y={},m=t("./util.js"),g=t("./promise_resolver.js")._nodebackForPromise,b=m.withAppended,w=m.maybeWrapAsError,j=m.canEvaluate,E=t("./errors").TypeError,k="Async",F=function(t,e){return m.isIdentifier(t)&&"_"!==t.charAt(0)&&!m.isClass(e)},A={__isPromisified__:!0},T=j?p:d;e.promisify=function(t,e){if("function"!=typeof t)throw new E("fn must be a function");return i(t)?t:_(t,arguments.length<2?y:e)},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new E("the target of promisifyAll must be an object or a function");e=Object(e);var n=e.suffix;"string"!=typeof n&&(n=k);var r=e.filter;"function"!=typeof r&&(r=F);var i=e.promisifier;if("function"!=typeof i&&(i=T),!m.isIdentifier(n))throw new RangeError("suffix must be a valid identifier");for(var o=m.inheritedDataKeys(t,{includeHidden:!0}),s=0;s<o.length;++s){var u=t[o[s]];"constructor"!==o[s]&&m.isClass(u)&&(v(u.prototype,n,r,i),v(u,n,r,i))}return v(t,n,r,i)}}},{"./errors":12,"./promise_resolver.js":24,"./util.js":37}],26:[function(t,e){"use strict";e.exports=function(e,n,r){function i(t){for(var e=c.keys(t),n=e.length,r=new Array(2*n),i=0;n>i;++i){var o=e[i];r[i]=t[o],r[i+n]=o}this.constructor$(r)}function o(t){var n,o=r(t,void 0);return a(o)?(n=o instanceof e?o._then(e.props,void 0,void 0,void 0,void 0):new i(o).promise(),o instanceof e&&n._propagateFrom(o,4),n):u("cannot await properties of a non-object")}var s=t("./util.js"),u=t("./errors_api_rejection")(e),a=s.isObject,c=t("./es5.js");s.inherits(i,n),i.prototype._init=function(){this._init$(void 0,-3)},i.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var n=++this._totalResolved;if(n>=this._length){for(var r={},i=this.length(),o=0,s=this.length();s>o;++o)r[this._values[o+i]]=this._values[o];this._resolve(r)}}},i.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({key:this._values[e+this.length()],value:t})},i.prototype.shouldCopyValues=function(){return!1},i.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return o(this)},e.props=function(t){return o(t)}}},{"./errors_api_rejection":13,"./es5.js":14,"./util.js":37}],27:[function(t,e){"use strict";function n(t,e,n,r,i){for(var o=0;i>o;++o)n[o+r]=t[o+e]}function r(t){this._capacity=t,this._length=0,this._front=0,this._makeCapacity()}r.prototype._willBeOverCapacity=function(t){return this._capacity<t},r.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var n=this._front+e&this._capacity-1;this[n]=t,this._length=e+1},r.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},r.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},r.prototype.length=function(){return this._length},r.prototype._makeCapacity=function(){for(var t=this._capacity,e=0;t>e;++e)this[e]=void 0},r.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<3)},r.prototype._resizeTo=function(t){var e=this._front,r=this._capacity,i=new Array(r),o=this.length();if(n(this,0,i,0,r),this._capacity=t,this._makeCapacity(),this._front=0,r>=e+o)n(i,e,this,0,o);else{var s=o-(e+o&r-1);n(i,e,this,0,s),n(i,0,this,s,o-s)}},e.exports=r},{}],28:[function(t,e){"use strict";e.exports=function(e,n,r){function i(t,i){var c=r(t,void 0);if(c instanceof e)return u(c);if(!s(t))return o("expecting an array, a promise or a thenable");var l=new e(n);void 0!==i?l._propagateFrom(i,7):l._setTrace(void 0);for(var f=l._fulfill,h=l._reject,p=0,d=t.length;d>p;++p){var v=t[p];(void 0!==v||a.call(t,p))&&e.cast(v)._then(f,h,void 0,l,null)}return l}var o=t("./errors_api_rejection.js")(e),s=t("./util.js").isArray,u=function(t){return t.then(function(e){return i(e,t)})},a={}.hasOwnProperty;e.race=function(t){return i(t,void 0)},e.prototype.race=function(){return i(this,void 0)}}},{"./errors_api_rejection.js":13,"./util.js":37}],29:[function(t,e){"use strict";e.exports=function(e,n,r,i,o){function s(t,n,r,s){this.constructor$(t),this._preservedValues=s===o?[]:null,this._zerothIsAccum=void 0===r,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var u=i(r,void 0),a=!1,c=u instanceof e;c&&(u.isPending()?u._proxyPromiseArray(this,-1):u.isFulfilled()?(r=u.value(),this._gotAccum=!0):(u._unsetRejectionIsUnhandled(),this._reject(u.reason()),a=!0)),c||this._zerothIsAccum||(this._gotAccum=!0),this._callback=n,this._accum=r,a||this._init$(void 0,-5)}function u(t,e,n,i){if("function"!=typeof e)return r("fn must be a function");var o=new s(t,e,n,i);return o.promise()}var a=t("./util.js"),c=a.tryCatch4,l=a.tryCatch3,f=a.errorObj;a.inherits(s,n),s.prototype._init=function(){},s.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},s.prototype._promiseFulfilled=function(t,n){var r=this._values;if(null!==r){var o,s=this.length(),u=this._preservedValues,a=null!==u,h=this._gotAccum,p=this._valuesPhase;if(!p)for(p=this._valuesPhase=Array(s),o=0;s>o;++o)p[o]=0;if(o=p[n],0===n&&this._zerothIsAccum?(h||(this._accum=t,this._gotAccum=h=!0),p[n]=0===o?1:2):-1===n?h||(this._accum=t,this._gotAccum=h=!0):0===o?p[n]=1:(p[n]=2,h&&(this._accum=t)),h){for(var d,v=this._callback,_=this._promise._boundTo,y=this._reducingIndex;s>y;++y)if(o=p[y],2!==o){if(1!==o)return;if(t=r[y],t instanceof e){if(!t.isFulfilled())return t.isPending()?void 0:(t._unsetRejectionIsUnhandled(),this._reject(t.reason()));t=t._settledValue}if(a?(u.push(t),d=l(v,_,t,y,s)):d=c(v,_,this._accum,t,y,s),d===f)return this._reject(d.e);var m=i(d,void 0);if(m instanceof e){if(m.isPending())return p[y]=4,m._proxyPromiseArray(this,y);if(!m.isFulfilled())return m._unsetRejectionIsUnhandled(),this._reject(m.reason());d=m.value()}this._reducingIndex=y+1,this._accum=d}else this._reducingIndex=y+1;this._reducingIndex<s||this._resolve(a?u:this._accum)}}},e.prototype.reduce=function(t,e){return u(this,t,e,null)},e.reduce=function(t,e,n,r){return u(t,e,n,r)}}},{"./util.js":37}],30:[function(t,e){(function(t){"use strict";var n,r;if("object"==typeof t&&"string"==typeof t.version)n=function(e){t.nextTick(e)};else if("undefined"!=typeof MutationObserver&&(r=MutationObserver)||"undefined"!=typeof WebKitMutationObserver&&(r=WebKitMutationObserver))n=function(){var t=document.createElement("div"),e=void 0,n=new r(function(){var t=e;
e=void 0,t()});return n.observe(t,{attributes:!0}),function(n){e=n,t.classList.toggle("foo")}}();else{if("undefined"==typeof setTimeout)throw new Error("no async scheduler available");n=function(t){setTimeout(t,0)}}e.exports=n}).call(this,t("_process"))},{_process:38}],31:[function(t,e){"use strict";e.exports=function(e,n){function r(t){this.constructor$(t)}var i=e.PromiseInspection,o=t("./util.js");o.inherits(r,n),r.prototype._promiseResolved=function(t,e){this._values[t]=e;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},r.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){var n=new i;n._bitField=268435456,n._settledValue=t,this._promiseResolved(e,n)}},r.prototype._promiseRejected=function(t,e){if(!this._isResolved()){var n=new i;n._bitField=134217728,n._settledValue=t,this._promiseResolved(e,n)}},e.settle=function(t){return new r(t).promise()},e.prototype.settle=function(){return new r(this).promise()}}},{"./util.js":37}],32:[function(t,e){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(t,e){if((0|e)!==e||0>e)return r("expecting a positive integer");var n=new i(t),o=n.promise();return o.isRejected()?o:(n.setHowMany(e),n.init(),o)}var s=t("./util.js"),u=t("./errors.js").RangeError,a=t("./errors.js").AggregateError,c=s.isArray;s.inherits(i,n),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=c(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(t){this._isResolved()||(this._howMany=t)},i.prototype._promiseFulfilled=function(t){this._isResolved()||(this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this._resolve(1===this.howMany()&&this._unwrap?this._values[0]:this._values)))},i.prototype._promiseRejected=function(t){if(!this._isResolved()&&(this._addRejected(t),this.howMany()>this._canPossiblyFulfill())){for(var e=new a,n=this.length();n<this._values.length;++n)e.push(this._values[n]);this._reject(e)}},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(t){this._values.push(t)},i.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new u(e)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return o(t,e)},e.prototype.some=function(t){return o(this,t)},e._SomePromiseArray=i}},{"./errors.js":12,"./util.js":37}],33:[function(t,e){"use strict";e.exports=function(t){function e(t){void 0!==t?(this._bitField=t._bitField,this._settledValue=t.isResolved()?t._settledValue:void 0):(this._bitField=0,this._settledValue=void 0)}e.prototype.isFulfilled=t.prototype.isFulfilled=function(){return(268435456&this._bitField)>0},e.prototype.isRejected=t.prototype.isRejected=function(){return(134217728&this._bitField)>0},e.prototype.isPending=t.prototype.isPending=function(){return 0===(402653184&this._bitField)},e.prototype.value=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");return this._settledValue},e.prototype.error=e.prototype.reason=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise");return this._settledValue},e.prototype.isResolved=t.prototype.isResolved=function(){return(402653184&this._bitField)>0},t.PromiseInspection=e}},{}],34:[function(t,e){"use strict";e.exports=function(e,n){function r(t){try{return t.then}catch(e){return c.e=e,c}}function i(t,i){if(l(t)){if(t instanceof e)return t;if(o(t)){var u=new e(n);return u._setTrace(void 0),t._then(u._fulfillUnchecked,u._rejectUncheckedCheckError,u._progressUnchecked,u,null),u._setFollowing(),u}var f=r(t);if(f===c)return void 0!==i&&a(f.e)&&i._attachExtraTrace(f.e),e.reject(f.e);if("function"==typeof f)return s(t,f,i)}return t}function o(t){return f.call(t,"_promise0")}function s(t,n,r){function i(n){if(!c){if(c=!0,t===n){var i=e._makeSelfResolutionError();return void 0!==r&&r._attachExtraTrace(i),void u.promise._reject(i,void 0)}u.resolve(n)}}function o(t){if(!c){c=!0;var e=a(t)?t:new Error(t+"");void 0!==r&&r._attachExtraTrace(e),u.promise._reject(t,e)}}function s(t){if(!c){var e=u.promise;"function"==typeof e._progress&&e._progress(t)}}var u=e.defer(),c=!1;try{n.call(t,i,o,s)}catch(l){if(!c){c=!0;var f=a(l)?l:new Error(l+"");void 0!==r&&r._attachExtraTrace(f),u.promise._reject(l,f)}}return u.promise}var u=t("./util.js"),a=t("./errors.js").canAttach,c=u.errorObj,l=u.isObject,f={}.hasOwnProperty;return i}},{"./errors.js":12,"./util.js":37}],35:[function(t,e){"use strict";var n=function(t,e){var n=arguments.length,r=arguments[2],i=arguments[3],o=n>=5?arguments[4]:void 0;setTimeout(function(){t(r,i,o)},0|e)};e.exports=function(e,r,i){var o=(t("./util.js"),t("./errors.js")),s=(t("./errors_api_rejection")(e),e.TimeoutError),u=function(t,e,n){if(t.isPending()){"string"!=typeof e&&(e="operation timed out after "+n+" ms");var r=new s(e);o.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._cancel(r)}},a=function(t,e){e._fulfill(t)},c=e.delay=function(t,o){void 0===o&&(o=t,t=void 0),o=+o;var s=i(t,void 0),u=new e(r);return s instanceof e?(u._propagateFrom(s,7),u._follow(s),u.then(function(t){return e.delay(t,o)})):(u._setTrace(void 0),n(a,o,t,u),u)};e.prototype.delay=function(t){return c(this,t)},e.prototype.timeout=function(t,i){t=+t;var o=new e(r);return o._propagateFrom(this,7),o._follow(this),n(u,t,o,i,t),o.cancellable()}}},{"./errors.js":12,"./errors_api_rejection":13,"./util.js":37}],36:[function(t,e){"use strict";e.exports=function(e,n,r){function i(t){for(var n=t.length,r=0;n>r;++r){var i=t[r];if(i.isRejected())return e.reject(i.error());t[r]=i.value()}return t}function o(t){setTimeout(function(){throw t},0)}function s(t){var e=r(t,void 0);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function u(t,n){function i(){if(u>=a)return c.resolve();var l=s(t[u++]);if(l instanceof e&&l._isDisposable()){try{l=r(l._getDisposer().tryDispose(n),void 0)}catch(f){return o(f)}if(l instanceof e)return l._then(i,o,null,null,null)}i()}var u=0,a=t.length,c=e.defer();return i(),c.promise}function a(t){var e=new d;return e._settledValue=t,e._bitField=268435456,u(this,e).thenReturn(t)}function c(t){var e=new d;return e._settledValue=t,e._bitField=134217728,u(this,e).thenThrow(t)}function l(t,e){this._data=t,this._promise=e}function f(t,e){this.constructor$(t,e)}var h=t("./errors.js").TypeError,p=t("./util.js").inherits,d=e.PromiseInspection;l.prototype.data=function(){return this._data},l.prototype.promise=function(){return this._promise},l.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},l.prototype.tryDispose=function(t){var e=this.resource(),n=null!==e?this.doDispose(e,t):null;return this._promise._unsetDisposable(),this._data=this._promise=null,n},l.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},p(f,l),f.prototype.doDispose=function(t,e){var n=this.data();return n.call(t,t,e)},e.using=function(){var t=arguments.length;if(2>t)return n("you must pass at least 2 arguments to Promise.using");var r=arguments[t-1];if("function"!=typeof r)return n("fn must be a function");t--;for(var o=new Array(t),s=0;t>s;++s){var u=arguments[s];if(l.isDisposer(u)){var f=u;u=u.promise(),u._setDisposable(f)}o[s]=u}return e.settle(o).then(i).spread(r)._then(a,c,void 0,o,void 0)},e.prototype._setDisposable=function(t){this._bitField=262144|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(262144&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new f(t,this);throw new h}}},{"./errors.js":12,"./util.js":37}],37:[function(t,e,n){"use strict";function r(t,e,n){try{return t.call(e,n)}catch(r){return E.e=r,E}}function i(t,e,n,r){try{return t.call(e,n,r)}catch(i){return E.e=i,E}}function o(t,e,n,r,i){try{return t.call(e,n,r,i)}catch(o){return E.e=o,E}}function s(t,e,n,r,i,o){try{return t.call(e,n,r,i,o)}catch(s){return E.e=s,E}}function u(t,e,n){try{return t.apply(n,e)}catch(r){return E.e=r,E}}function a(t){return"string"==typeof t?t:""+t}function c(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function l(t){return!c(t)}function f(t){return c(t)?new Error(a(t)):t}function h(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;r>n;++n)i[n]=t[n];return i[n]=e,i}function p(t,e,n){if(!b.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function d(t,e,n){if(c(t))return t;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return b.defineProperty(t,e,r),t}function v(t){throw t}function _(t){try{if("function"==typeof t){var e=b.keys(t.prototype);return e.length>0&&!(1===e.length&&"constructor"===e[0])}return!1}catch(n){return!1}}function y(t){function e(){}return e.prototype=t,e}function m(t){return T.test(t)}function g(t,e,n){for(var r=new Array(t),i=0;t>i;++i)r[i]=e+i+n;return r}var b=t("./es5.js"),w=function(){try{var t={};return b.defineProperty(t,"f",{get:function(){return 3}}),3===t.f}catch(e){return!1}}(),j="undefined"==typeof navigator,E={e:{}},k=function(t,e){function n(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var r={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n,t.prototype},F=function(){return"string"!==this}.call("string"),A=function(){return b.isES5?function(t,e){for(var n=[],r=Object.create(null),i=Object(e).includeHidden?Object.getOwnPropertyNames:Object.keys;null!=t;){var o;try{o=i(t)}catch(s){return n}for(var u=0;u<o.length;++u){var a=o[u];if(!r[a]){r[a]=!0;var c=Object.getOwnPropertyDescriptor(t,a);null!=c&&null==c.get&&null==c.set&&n.push(a)}}t=b.getPrototypeOf(t)}return n}:function(t){var e=[];for(var n in t)e.push(n);return e}}(),T=/^[a-z$_][a-z$_0-9]*$/i,x={isClass:_,isIdentifier:m,inheritedDataKeys:A,getDataPropertyOrDefault:p,thrower:v,isArray:b.isArray,haveGetters:w,notEnumerableProp:d,isPrimitive:c,isObject:l,canEvaluate:j,errorObj:E,tryCatch1:r,tryCatch2:i,tryCatch3:o,tryCatch4:s,tryCatchApply:u,inherits:k,withAppended:h,asString:a,maybeWrapAsError:f,wrapsPrimitiveReceiver:F,toFastProperties:y,filledRange:g};e.exports=x},{"./es5.js":14}],38:[function(t,e){function n(){}var r=e.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},{}],39:[function(e,n,r){!function(){function e(){this._events={},this._conf&&n.call(this,this._conf)}function n(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),t.maxListeners&&(this._events.maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this.newListener=t.newListener),this.wildcard&&(this.listenerTree={}))}function i(t){this._events={},this.newListener=!1,n.call(this,t)}function o(t,e,n,r){if(!n)return[];var i,s,u,a,c,l,f,h=[],p=e.length,d=e[r],v=e[r+1];if(r===p&&n._listeners){if("function"==typeof n._listeners)return t&&t.push(n._listeners),[n];for(i=0,s=n._listeners.length;s>i;i++)t&&t.push(n._listeners[i]);return[n]}if("*"===d||"**"===d||n[d]){if("*"===d){for(u in n)"_listeners"!==u&&n.hasOwnProperty(u)&&(h=h.concat(o(t,e,n[u],r+1)));return h}if("**"===d){f=r+1===p||r+2===p&&"*"===v,f&&n._listeners&&(h=h.concat(o(t,e,n,p)));for(u in n)"_listeners"!==u&&n.hasOwnProperty(u)&&("*"===u||"**"===u?(n[u]._listeners&&!f&&(h=h.concat(o(t,e,n[u],p))),h=h.concat(o(t,e,n[u],r))):h=h.concat(u===v?o(t,e,n[u],r+2):o(t,e,n[u],r)));return h}h=h.concat(o(t,e,n[d],r+1))}if(a=n["*"],a&&o(t,e,a,r+1),c=n["**"])if(p>r){c._listeners&&o(t,e,c,p);for(u in c)"_listeners"!==u&&c.hasOwnProperty(u)&&(u===v?o(t,e,c[u],r+2):u===d?o(t,e,c[u],r+1):(l={},l[u]=c[u],o(t,e,{"**":l},r+1)))}else c._listeners?o(t,e,c,p):c["*"]&&c["*"]._listeners&&o(t,e,c["*"],p);return h}function s(t,e){t="string"==typeof t?t.split(this.delimiter):t.slice();for(var n=0,r=t.length;r>n+1;n++)if("**"===t[n]&&"**"===t[n+1])return;for(var i=this.listenerTree,o=t.shift();o;){if(i[o]||(i[o]={}),i=i[o],0===t.length){if(i._listeners){if("function"==typeof i._listeners)i._listeners=[i._listeners,e];else if(u(i._listeners)&&(i._listeners.push(e),!i._listeners.warned)){var s=a;"undefined"!=typeof this._events.maxListeners&&(s=this._events.maxListeners),s>0&&i._listeners.length>s&&(i._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",i._listeners.length),console.trace())}}else i._listeners=e;return!0}o=t.shift()}return!0}var u=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},a=10;i.prototype.delimiter=".",i.prototype.setMaxListeners=function(t){this._events||e.call(this),this._events.maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t},i.prototype.event="",i.prototype.once=function(t,e){return this.many(t,1,e),this},i.prototype.many=function(t,e,n){function r(){0===--e&&i.off(t,r),n.apply(this,arguments)}var i=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");return r._origin=n,this.on(t,r),i},i.prototype.emit=function(){this._events||e.call(this);var t=arguments[0];if("newListener"===t&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var n=arguments.length,r=new Array(n-1),i=1;n>i;i++)r[i-1]=arguments[i];for(i=0,n=this._all.length;n>i;i++)this.event=t,this._all[i].apply(this,r)}if("error"===t&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var s;if(this.wildcard){s=[];var u="string"==typeof t?t.split(this.delimiter):t.slice();o.call(this,s,u,this.listenerTree,0)}else s=this._events[t];if("function"==typeof s){if(this.event=t,1===arguments.length)s.call(this);else if(arguments.length>1)switch(arguments.length){case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:for(var n=arguments.length,r=new Array(n-1),i=1;n>i;i++)r[i-1]=arguments[i];s.apply(this,r)}return!0}if(s){for(var n=arguments.length,r=new Array(n-1),i=1;n>i;i++)r[i-1]=arguments[i];for(var a=s.slice(),i=0,n=a.length;n>i;i++)this.event=t,a[i].apply(this,r);return a.length>0||!!this._all}return!!this._all},i.prototype.on=function(t,n){if("function"==typeof t)return this.onAny(t),this;if("function"!=typeof n)throw new Error("on only accepts instances of Function");if(this._events||e.call(this),this.emit("newListener",t,n),this.wildcard)return s.call(this,t,n),this;if(this._events[t]){if("function"==typeof this._events[t])this._events[t]=[this._events[t],n];else if(u(this._events[t])&&(this._events[t].push(n),!this._events[t].warned)){var r=a;"undefined"!=typeof this._events.maxListeners&&(r=this._events.maxListeners),r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}}else this._events[t]=n;return this},i.prototype.onAny=function(t){if("function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(t),this},i.prototype.addListener=i.prototype.on,i.prototype.off=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");var n,r=[];if(this.wildcard){var i="string"==typeof t?t.split(this.delimiter):t.slice();r=o.call(this,null,i,this.listenerTree,0)}else{if(!this._events[t])return this;n=this._events[t],r.push({_listeners:n})}for(var s=0;s<r.length;s++){var a=r[s];if(n=a._listeners,u(n)){for(var c=-1,l=0,f=n.length;f>l;l++)if(n[l]===e||n[l].listener&&n[l].listener===e||n[l]._origin&&n[l]._origin===e){c=l;break}if(0>c)continue;return this.wildcard?a._listeners.splice(c,1):this._events[t].splice(c,1),0===n.length&&(this.wildcard?delete a._listeners:delete this._events[t]),this}(n===e||n.listener&&n.listener===e||n._origin&&n._origin===e)&&(this.wildcard?delete a._listeners:delete this._events[t])}return this},i.prototype.offAny=function(t){var e,n=0,r=0;if(t&&this._all&&this._all.length>0){for(e=this._all,n=0,r=e.length;r>n;n++)if(t===e[n])return e.splice(n,1),this}else this._all=[];return this},i.prototype.removeListener=i.prototype.off,i.prototype.removeAllListeners=function(t){if(0===arguments.length)return!this._events||e.call(this),this;if(this.wildcard)for(var n="string"==typeof t?t.split(this.delimiter):t.slice(),r=o.call(this,null,n,this.listenerTree,0),i=0;i<r.length;i++){var s=r[i];s._listeners=null}else{if(!this._events[t])return this;this._events[t]=null}return this},i.prototype.listeners=function(t){if(this.wildcard){var n=[],r="string"==typeof t?t.split(this.delimiter):t.slice();return o.call(this,n,r,this.listenerTree,0),n}return this._events||e.call(this),this._events[t]||(this._events[t]=[]),u(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},i.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof t&&t.amd?t(function(){return i}):"object"==typeof r?r.EventEmitter2=i:window.EventEmitter2=i}()},{}]},{},[1])(1)});